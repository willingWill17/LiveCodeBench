{"question_id": "abc385_e", "question_title": "Snowflake Tree", "question_content": "A \"Snowflake Tree\" is defined as a tree that can be generated by the following procedure:\n\n- Choose positive integers x,y.\n- Prepare one vertex.\n- Prepare x more vertices, and connect each of them to the vertex prepared in step 2.\n- For each of the x vertices prepared in step 3, attach y leaves to it.\n\nThe figure below shows a Snowflake Tree with x=4,y=2. The vertices prepared in steps 2, 3, 4 are shown in red, blue, and green, respectively.\n\nYou are given a tree T with N vertices. The vertices are numbered 1 to N, and the i-th edge (i=1,2,\\dots,N-1) connects vertices u_i and v_i.\nConsider deleting zero or more vertices of T and the edges adjacent to them so that the remaining graph becomes a single Snowflake Tree. Find the minimum number of vertices that must be deleted. Under the constraints of this problem, it is always possible to transform T into a Snowflake Tree.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN\r\nu_1 v_1\r\nu_2 v_2\r\n\\vdots\r\nu_{N-1} v_{N-1}\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- 3 \\leq N \\leq 3 \\times 10^5\n- 1 \\leq u_i < v_i \\leq N\n- The given graph is a tree.\n- All input values are integers.\n\nSample Input 1\n\n8\r\n1 3\r\n2 3\r\n3 4\r\n4 5\r\n5 6\r\n5 7\r\n4 8\n\nSample Output 1\n\n1\r\n\nBy deleting vertex 8, the given tree can be transformed into a Snowflake Tree with x=2,y=2.\n\nSample Input 2\n\n3\r\n1 2\r\n2 3\n\nSample Output 2\n\n0\r\n\nThe given tree is already a Snowflake Tree with x=1,y=1.\n\nSample Input 3\n\n10\r\n1 3\r\n1 2\r\n5 7\r\n6 10\r\n2 8\r\n1 6\r\n8 9\r\n2 7\r\n1 4\n\nSample Output 3\n\n3", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"8\\n1 3\\n2 3\\n3 4\\n4 5\\n5 6\\n5 7\\n4 8\", \"output\": \"1\", \"testtype\": \"stdin\"}, {\"input\": \"3\\n1 2\\n2 3\", \"output\": \"0\", \"testtype\": \"stdin\"}, {\"input\": \"10\\n1 3\\n1 2\\n5 7\\n6 10\\n2 8\\n1 6\\n8 9\\n2 7\\n1 4\", \"output\": \"3\", \"testtype\": \"stdin\"}]"}
{"question_id": "3603", "question_title": "check-if-dfs-strings-are-palindromes", "question_content": "You are given a tree rooted at node 0, consisting of n nodes numbered from 0 to n - 1. The tree is represented by an array parent of size n, where parent[i] is the parent of node i. Since node 0 is the root, parent[0] == -1.\nYou are also given a string s of length n, where s[i] is the character assigned to node i.\nConsider an empty string dfsStr, and define a recursive function dfs(int x) that takes a node x as a parameter and performs the following steps in order:\n\nIterate over each child y of x in increasing order of their numbers, and call dfs(y).\nAdd the character s[x] to the end of the string dfsStr.\n\nNote that dfsStr is shared across all recursive calls of dfs.\nYou need to find a boolean array answer of size n, where for each index i from 0 to n - 1, you do the following:\n\nEmpty the string dfsStr and call dfs(i).\nIf the resulting string dfsStr is a palindrome, then set answer[i] to true. Otherwise, set answer[i] to false.\n\nReturn the array answer.\n \nExample 1:\n\n\nInput: parent = [-1,0,0,1,1,2], s = \"aababa\"\nOutput: [true,true,false,true,true,true]\nExplanation:\n\nCalling dfs(0) results in the string dfsStr = \"abaaba\", which is a palindrome.\nCalling dfs(1) results in the string dfsStr = \"aba\", which is a palindrome.\nCalling dfs(2) results in the string dfsStr = \"ab\", which is not a palindrome.\nCalling dfs(3) results in the string dfsStr = \"a\", which is a palindrome.\nCalling dfs(4) results in the string dfsStr = \"b\", which is a palindrome.\nCalling dfs(5) results in the string dfsStr = \"a\", which is a palindrome.\n\n\nExample 2:\n\n\nInput: parent = [-1,0,0,0,0], s = \"aabcb\"\nOutput: [true,true,true,true,true]\nExplanation:\nEvery call on dfs(x) results in a palindrome string.\n\n \nConstraints:\n\nn == parent.length == s.length\n1 <= n <= 10^5\n0 <= parent[i] <= n - 1 for all i >= 1.\nparent[0] == -1\nparent represents a valid tree.\ns consists only of lowercase English letters.", "difficulty": "hard", "starter_code": "class Solution:\n    def findAnswer(self, parent: List[int], s: str) -> List[bool]:\n        ", "public_test_cases": "[{\"input\": \"[-1, 0, 0, 1, 1, 2]\\n\\\"aababa\\\"\", \"output\": \"[true, true, false, true, true, true]\", \"testtype\": \"functional\"}, {\"input\": \"[-1, 0, 0, 0, 0]\\n\\\"aabcb\\\"\", \"output\": \"[true, true, true, true, true]\", \"testtype\": \"functional\"}]"}
{"question_id": "abc399_a", "question_title": "Hamming Distance", "question_content": "You are given a positive integer N and two strings S and T, each of length N and consisting of lowercase English letters.\nFind the Hamming distance between S and T. That is, find the number of integers i such that 1 \\leq i \\leq N and the i-th character of S is different from the i-th character of T.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN\r\nS\r\nT\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- 1\\leq N \\leq 100\n- N is an integer.\n- Each of S and T is a string of length N consisting of lowercase English letters.\n\nSample Input 1\n\n6\r\nabcarc\r\nagcahc\n\nSample Output 1\n\n2\r\n\nS and T differ in the 2nd and 5th characters, but not in other characters. Thus, the answer is 2.\n\nSample Input 2\n\n7\r\natcoder\r\ncontest\n\nSample Output 2\n\n7\n\nSample Input 3\n\n8\r\nchokudai\r\nchokudai\n\nSample Output 3\n\n0\n\nSample Input 4\n\n10\r\nvexknuampx\r\nvzxikuamlx\n\nSample Output 4\n\n4", "difficulty": "easy", "starter_code": "", "public_test_cases": "[{\"input\": \"6\\nabcarc\\nagcahc\", \"output\": \"2\", \"testtype\": \"stdin\"}, {\"input\": \"7\\natcoder\\ncontest\", \"output\": \"7\", \"testtype\": \"stdin\"}, {\"input\": \"8\\nchokudai\\nchokudai\", \"output\": \"0\", \"testtype\": \"stdin\"}, {\"input\": \"10\\nvexknuampx\\nvzxikuamlx\", \"output\": \"4\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc357_e", "question_title": "Reachability in Functional Graph", "question_content": "There is a directed graph with N vertices numbered 1 to N and N edges.\r\nThe out-degree of every vertex is 1, and the edge from vertex i points to vertex a_i.\r\nCount the number of pairs of vertices (u, v) such that vertex v is reachable from vertex u.\nHere, vertex v is reachable from vertex u if there exists a sequence of vertices w_0, w_1, \\dots, w_K of length K+1 that satisfies the following conditions. In particular, if u = v, it is always reachable.\n\n- w_0 = u.\n- w_K = v.\n- For every 0 \\leq i \\lt K, there is an edge from vertex w_i to vertex w_{i+1}.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN\r\na_1 a_2 \\dots a_N\n\nOutput\n\nPrint the number of pairs of vertices (u, v) such that vertex v is reachable from vertex u.\n\nConstraints\n\n\n- 1 \\leq N \\leq 2 \\times 10^5\n- 1 \\leq a_i \\leq N\n- All input values are integers.\n\nSample Input 1\n\n4\r\n2 1 1 4\n\nSample Output 1\n\n8\r\n\nThe vertices reachable from vertex 1 are vertices 1, 2.\r\nThe vertices reachable from vertex 2 are vertices 1, 2.\r\nThe vertices reachable from vertex 3 are vertices 1, 2, 3.\r\nThe vertex reachable from vertex 4 is vertex 4.\r\nTherefore, the number of pairs of vertices (u, v) such that vertex v is reachable from vertex u is 8.\r\nNote that the edge from vertex 4 is a self-loop, that is, it points to vertex 4 itself.\n\nSample Input 2\n\n5\r\n2 4 3 1 2\n\nSample Output 2\n\n14\n\nSample Input 3\n\n10\r\n6 10 4 1 5 9 8 6 5 1\n\nSample Output 3\n\n41", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"4\\n2 1 1 4\\n\", \"output\": \"8\\n\", \"testtype\": \"stdin\"}, {\"input\": \"5\\n2 4 3 1 2\\n\", \"output\": \"14\\n\", \"testtype\": \"stdin\"}, {\"input\": \"10\\n6 10 4 1 5 9 8 6 5 1\\n\", \"output\": \"41\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc362_d", "question_title": "Shortest Path 3", "question_content": "You are given a simple connected undirected graph with N vertices and M edges. Each vertex i\\,(1\\leq i \\leq N) has a weight A_i. Each edge j\\,(1\\leq j \\leq M) connects vertices U_j and V_j bidirectionally and has a weight B_j.\nThe weight of a path in this graph is defined as the sum of the weights of the vertices and edges that appear on the path.\nFor each i=2,3,\\dots,N, solve the following problem:\n\n- Find the minimum weight of a path from vertex 1 to vertex i.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\nA_1 A_2 \\dots A_N\r\nU_1 V_1 B_1\r\nU_2 V_2 B_2\r\n\\vdots\r\nU_M V_M B_M\n\nOutput\n\nPrint the answers for i=2,3,\\dots,N in a single line, separated by spaces.\n\nConstraints\n\n\n- 2 \\leq N \\leq 2 \\times 10^5\n- N-1 \\leq M \\leq 2 \\times 10^5\n- 1 \\leq U_j < V_j \\leq N\n- (U_i, V_i) \\neq (U_j, V_j) if i \\neq j.\n- The graph is connected.\n- 0 \\leq A_i \\leq 10^9\n- 0 \\leq B_j \\leq 10^9\n- All input values are integers.\n\nSample Input 1\n\n3 3\r\n1 2 3\r\n1 2 1\r\n1 3 6\r\n2 3 2\n\nSample Output 1\n\n4 9\r\n\nConsider the paths from vertex 1 to vertex 2.\r\nThe weight of the path 1 \\to 2 is A_1 + B_1 + A_2 = 1 + 1 + 2 = 4, and the weight of the path 1 \\to 3 \\to 2 is A_1 + B_2 + A_3 + B_3 + A_2 = 1 + 6 + 3 + 2 + 2 = 14. The minimum weight is 4.\nConsider the paths from vertex 1 to vertex 3.\r\nThe weight of the path 1 \\to 3 is A_1 + B_2 + A_3 = 1 + 6 + 3 = 10, and the weight of the path 1 \\to 2 \\to 3 is A_1 + B_1 + A_2 + B_3 + A_3 = 1 + 1 + 2 + 2 + 3 = 9. The minimum weight is 9.\n\nSample Input 2\n\n2 1\r\n0 1\r\n1 2 3\n\nSample Output 2\n\n4\n\nSample Input 3\n\n5 8\r\n928448202 994752369 906965437 942744902 907560126\r\n2 5 975090662\r\n1 2 908843627\r\n1 5 969061140\r\n3 4 964249326\r\n2 3 957690728\r\n2 4 942986477\r\n4 5 948404113\r\n1 3 988716403\n\nSample Output 3\n\n2832044198 2824130042 4696218483 2805069468\r\n\nNote that the answers may not fit in a 32-bit integer.", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 3\\n1 2 3\\n1 2 1\\n1 3 6\\n2 3 2\\n\", \"output\": \"4 9\\n\", \"testtype\": \"stdin\"}, {\"input\": \"2 1\\n0 1\\n1 2 3\\n\", \"output\": \"4\\n\", \"testtype\": \"stdin\"}, {\"input\": \"5 8\\n928448202 994752369 906965437 942744902 907560126\\n2 5 975090662\\n1 2 908843627\\n1 5 969061140\\n3 4 964249326\\n2 3 957690728\\n2 4 942986477\\n4 5 948404113\\n1 3 988716403\\n\", \"output\": \"2832044198 2824130042 4696218483 2805069468\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "3478", "question_title": "check-if-the-rectangle-corner-is-reachable", "question_content": "You are given two positive integers xCorner and yCorner, and a 2D array circles, where circles[i] = [x_i, y_i, r_i] denotes a circle with center at (x_i, y_i) and radius r_i.\nThere is a rectangle in the coordinate plane with its bottom left corner at the origin and top right corner at the coordinate (xCorner, yCorner). You need to check whether there is a path from the bottom left corner to the top right corner such that the entire path lies inside the rectangle, does not touch or lie inside any circle, and touches the rectangle only at the two corners.\nReturn true if such a path exists, and false otherwise.\n \nExample 1:\n\nInput: xCorner = 3, yCorner = 4, circles = [[2,1,1]]\nOutput: true\nExplanation:\n\nThe black curve shows a possible path between (0, 0) and (3, 4).\n\nExample 2:\n\nInput: xCorner = 3, yCorner = 3, circles = [[1,1,2]]\nOutput: false\nExplanation:\n\nNo path exists from (0, 0) to (3, 3).\n\nExample 3:\n\nInput: xCorner = 3, yCorner = 3, circles = [[2,1,1],[1,2,1]]\nOutput: false\nExplanation:\n\nNo path exists from (0, 0) to (3, 3).\n\nExample 4:\n\nInput: xCorner = 4, yCorner = 4, circles = [[5,5,1]]\nOutput: true\nExplanation:\n\n\n \nConstraints:\n\n3 <= xCorner, yCorner <= 10^9\n1 <= circles.length <= 1000\ncircles[i].length == 3\n1 <= x_i, y_i, r_i <= 10^9", "difficulty": "hard", "starter_code": "class Solution:\n    def canReachCorner(self, xCorner: int, yCorner: int, circles: List[List[int]]) -> bool:\n        ", "public_test_cases": "[{\"input\": \"3\\n4\\n[[2, 1, 1]]\", \"output\": \"true\", \"testtype\": \"functional\"}, {\"input\": \"3\\n3\\n[[1, 1, 2]]\", \"output\": \"false\", \"testtype\": \"functional\"}, {\"input\": \"3\\n3\\n[[2, 1, 1], [1, 2, 1]]\", \"output\": \"false\", \"testtype\": \"functional\"}, {\"input\": \"4\\n4\\n[[5, 5, 1]]\", \"output\": \"true\", \"testtype\": \"functional\"}]"}
{"question_id": "2791", "question_title": "find-the-losers-of-the-circular-game", "question_content": "There are n friends that are playing a game. The friends are sitting in a circle and are numbered from 1 to n in clockwise order. More formally, moving clockwise from the i^th friend brings you to the (i+1)^th friend for 1 <= i < n, and moving clockwise from the n^th friend brings you to the 1^st friend.\nThe rules of the game are as follows:\n1^st friend receives the ball.\n\nAfter that, 1^st friend passes it to the friend who is k steps away from them in the clockwise direction.\nAfter that, the friend who receives the ball should pass it to the friend who is 2 * k steps away from them in the clockwise direction.\nAfter that, the friend who receives the ball should pass it to the friend who is 3 * k steps away from them in the clockwise direction, and so on and so forth.\n\nIn other words, on the i^th turn, the friend holding the ball should pass it to the friend who is i * k steps away from them in the clockwise direction.\nThe game is finished when some friend receives the ball for the second time.\nThe losers of the game are friends who did not receive the ball in the entire game.\nGiven the number of friends, n, and an integer k, return the array answer, which contains the losers of the game in the ascending order.\n \nExample 1:\n\nInput: n = 5, k = 2\nOutput: [4,5]\nExplanation: The game goes as follows:\n1) Start at 1^st friend and pass the ball to the friend who is 2 steps away from them - 3^rd friend.\n2) 3^rd friend passes the ball to the friend who is 4 steps away from them - 2^nd friend.\n3) 2^nd friend passes the ball to the friend who is 6 steps away from them  - 3^rd friend.\n4) The game ends as 3^rd friend receives the ball for the second time.\n\nExample 2:\n\nInput: n = 4, k = 4\nOutput: [2,3,4]\nExplanation: The game goes as follows:\n1) Start at the 1^st friend and pass the ball to the friend who is 4 steps away from them - 1^st friend.\n2) The game ends as 1^st friend receives the ball for the second time.\n\n \nConstraints:\n\n1 <= k <= n <= 50", "difficulty": "easy", "starter_code": "class Solution:\n    def circularGameLosers(self, n: int, k: int) -> List[int]:\n        ", "public_test_cases": "[{\"input\": \"5\\n2\", \"output\": \"[4, 5]\", \"testtype\": \"functional\"}, {\"input\": \"4\\n4\", \"output\": \"[2, 3, 4]\", \"testtype\": \"functional\"}]"}
{"question_id": "2827", "question_title": "greatest-common-divisor-traversal", "question_content": "You are given a 0-indexed integer array nums, and you are allowed to traverse between its indices. You can traverse between index i and index j, i != j, if and only if gcd(nums[i], nums[j]) > 1, where gcd is the greatest common divisor.\nYour task is to determine if for every pair of indices i and j in nums, where i < j, there exists a sequence of traversals that can take us from i to j.\nReturn true if it is possible to traverse between all such pairs of indices, or false otherwise.\n \nExample 1:\n\nInput: nums = [2,3,6]\nOutput: true\nExplanation: In this example, there are 3 possible pairs of indices: (0, 1), (0, 2), and (1, 2).\nTo go from index 0 to index 1, we can use the sequence of traversals 0 -> 2 -> 1, where we move from index 0 to index 2 because gcd(nums[0], nums[2]) = gcd(2, 6) = 2 > 1, and then move from index 2 to index 1 because gcd(nums[2], nums[1]) = gcd(6, 3) = 3 > 1.\nTo go from index 0 to index 2, we can just go directly because gcd(nums[0], nums[2]) = gcd(2, 6) = 2 > 1. Likewise, to go from index 1 to index 2, we can just go directly because gcd(nums[1], nums[2]) = gcd(3, 6) = 3 > 1.\n\nExample 2:\n\nInput: nums = [3,9,5]\nOutput: false\nExplanation: No sequence of traversals can take us from index 0 to index 2 in this example. So, we return false.\n\nExample 3:\n\nInput: nums = [4,3,12,8]\nOutput: true\nExplanation: There are 6 possible pairs of indices to traverse between: (0, 1), (0, 2), (0, 3), (1, 2), (1, 3), and (2, 3). A valid sequence of traversals exists for each pair, so we return true.\n\n \nConstraints:\n\n1 <= nums.length <= 10^5\n1 <= nums[i] <= 10^5", "difficulty": "hard", "starter_code": "class Solution:\n    def canTraverseAllPairs(self, nums: List[int]) -> bool:\n        ", "public_test_cases": "[{\"input\": \"[2, 3, 6]\", \"output\": \"true\", \"testtype\": \"functional\"}, {\"input\": \"[3, 9, 5]\", \"output\": \"false\", \"testtype\": \"functional\"}, {\"input\": \"[4, 3, 12, 8]\", \"output\": \"true\", \"testtype\": \"functional\"}]"}
{"question_id": "abc302_c", "question_title": "Almost Equal", "question_content": "You are given N strings S_1,S_2,\\dots,S_N, each of length M, consisting of lowercase English letter.  Here, S_i are pairwise distinct.\nDetermine if one can rearrange these strings to obtain a new sequence of strings T_1,T_2,\\dots,T_N such that:\n\n- for all integers i such that 1 \\le i \\le N-1, one can alter exactly one character of T_i to another lowercase English letter to make it equal to T_{i+1}.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\nS_1\nS_2\n\\vdots\nS_N\n\nOutput\n\nPrint Yes if one can obtain a conforming sequence; print No otherwise.\n\nConstraints\n\n\n- 2 \\le N \\le 8\n- 1 \\le M \\le 5\n- S_i is a string of length M consisting of lowercase English letters.  (1 \\le i \\le N)\n- S_i are pairwise distinct.\n\nSample Input 1\n\n4 4\nbbed\nabcd\nabed\nfbed\n\nSample Output 1\n\nYes\n\nOne can rearrange them in this order: abcd, abed, bbed, fbed.  This sequence satisfies the condition.\n\nSample Input 2\n\n2 5\nabcde\nabced\n\nSample Output 2\n\nNo\n\nNo matter how the strings are rearranged, the condition is never satisfied.\n\nSample Input 3\n\n8 4\nfast\nface\ncast\nrace\nfact\nrice\nnice\ncase\n\nSample Output 3\n\nYes", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"4 4\\nbbed\\nabcd\\nabed\\nfbed\\n\", \"output\": \"Yes\\n\", \"testtype\": \"stdin\"}, {\"input\": \"2 5\\nabcde\\nabced\\n\", \"output\": \"No\\n\", \"testtype\": \"stdin\"}, {\"input\": \"8 4\\nfast\\nface\\ncast\\nrace\\nfact\\nrice\\nnice\\ncase\\n\", \"output\": \"Yes\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc302_e", "question_title": "Isolation", "question_content": "There is an undirected graph with N vertices numbered 1 through N, and initially with 0 edges.\r\nGiven Q queries, process them in order.  After processing each query,\r\nprint the number of vertices that are not connected to any other vertices by an edge.\nThe i-th query, \\mathrm{query}_i, is of one of the following two kinds.\n\n- \r\n1 u v: connect vertex u and vertex v with an edge.  It is guaranteed that, when this query is given, vertex u and vertex v are not connected by an edge.\n\n- \r\n2 v: remove all edges that connect vertex v and the other vertices.  (Vertex v itself is not removed.)\n\nInput\n\nThe input is given from Standard Input in the following format:\nN Q\r\n\\mathrm{query}_1\r\n\\mathrm{query}_2\r\n\\vdots\r\n\\mathrm{query}_Q\n\nOutput\n\nPrint Q lines.\r\nThe i-th line (1\\leq i\\leq Q) should contain the number of vertices that are not connected to any other vertices by an edge.\n\nConstraints\n\n\n- 2 \\leq N\\leq 3\\times 10^5\n- 1 \\leq Q\\leq 3\\times 10^5\n- For each query of the first kind, 1\\leq u,v\\leq N and u\\neq v.\n- For each query of the second kind, 1\\leq v\\leq N.\n- Right before a query of the first kind is given, there is no edge between vertices u and v.\n- All values in the input are integers.\n\nSample Input 1\n\n3 7\r\n1 1 2\r\n1 1 3\r\n1 2 3\r\n2 1\r\n1 1 2\r\n2 2\r\n1 1 2\n\nSample Output 1\n\n1\r\n0\r\n0\r\n1\r\n0\r\n3\r\n1\r\n\nAfter the first query, vertex 1 and vertex 2 are connected to each other by an edge, but vertex 3 is not connected to any other vertices.\r\nThus, 1 should be printed in the first line.\nAfter the third query, all pairs of different vertices are connected by an edge.\r\nHowever, the fourth query asks to remove all edges that connect vertex 1 and the other vertices, specifically to remove the edge between vertex 1 and vertex 2, and another between vertex 1 and vertex 3.\r\nAs a result, vertex 2 and vertex 3 are connected to each other, while vertex 1 is not connected to any other vertices by an edge.\r\nThus, 0 and 1 should be printed in the third and fourth lines, respectively.\n\nSample Input 2\n\n2 1\r\n2 1\n\nSample Output 2\n\n2\r\n\nWhen the query of the second kind is given, there may be no edge that connects that vertex and the other vertices.", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 7\\n1 1 2\\n1 1 3\\n1 2 3\\n2 1\\n1 1 2\\n2 2\\n1 1 2\\n\", \"output\": \"1\\n0\\n0\\n1\\n0\\n3\\n1\\n\", \"testtype\": \"stdin\"}, {\"input\": \"2 1\\n2 1\\n\", \"output\": \"2\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc302_f", "question_title": "Merge Set", "question_content": "On a blackboard, there are N sets S_1,S_2,\\dots,S_N consisting of integers between 1 and M. Here, S_i = \\lbrace S_{i,1},S_{i,2},\\dots,S_{i,A_i} \\rbrace.\nYou may perform the following operation any number of times (possibly zero):\n\n- choose two sets X and Y with at least one common element.  Erase them from the blackboard, and write X\\cup Y on the blackboard instead.\n\nHere, X\\cup Y denotes the set consisting of the elements contained in at least one of X and Y.\nDetermine if one can obtain a set containing both 1 and M.  If it is possible, find the minimum number of operations required to obtain it.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\nA_1\r\nS_{1,1} S_{1,2} \\dots S_{1,A_1}\r\nA_2\r\nS_{2,1} S_{2,2} \\dots S_{2,A_2}\r\n\\vdots\r\nA_N\r\nS_{N,1} S_{N,2} \\dots S_{N,A_N}\n\nOutput\n\nIf one can obtain a set containing both 1 and M, print the minimum number of operations required to obtain it; if it is impossible, print -1 instead.\n\nConstraints\n\n\n- 1 \\le N \\le 2 \\times 10^5\n- 2 \\le M \\le 2 \\times 10^5\n- 1 \\le \\sum_{i=1}^{N} A_i \\le 5 \\times 10^5\n- 1 \\le S_{i,j} \\le M(1 \\le i \\le N,1 \\le j \\le A_i)\n- S_{i,j} \\neq S_{i,k}(1 \\le j < k \\le A_i)\n- All values in the input are integers.\n\nSample Input 1\n\n3 5\r\n2\r\n1 2\r\n2\r\n2 3\r\n3\r\n3 4 5\n\nSample Output 1\n\n2\r\n\nFirst, choose and remove \\lbrace 1,2 \\rbrace and \\lbrace 2,3 \\rbrace to obtain \\lbrace 1,2,3 \\rbrace.\nThen, choose and remove \\lbrace 1,2,3 \\rbrace and \\lbrace 3,4,5 \\rbrace to obtain \\lbrace 1,2,3,4,5 \\rbrace.\nThus, one can obtain a set containing both 1 and M with two operations.  Since one cannot achieve the objective by performing the operation only once, the answer is 2.\n\nSample Input 2\n\n1 2\r\n2\r\n1 2\n\nSample Output 2\n\n0\r\n\nS_1 already contains both 1 and M, so the minimum number of operations required is 0.\n\nSample Input 3\n\n3 5\r\n2\r\n1 3\r\n2\r\n2 4\r\n3\r\n2 4 5\n\nSample Output 3\n\n-1\n\nSample Input 4\n\n4 8\r\n3\r\n1 3 5\r\n2\r\n1 2\r\n3\r\n2 4 7\r\n4\r\n4 6 7 8\n\nSample Output 4\n\n2", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 5\\n2\\n1 2\\n2\\n2 3\\n3\\n3 4 5\\n\", \"output\": \"2\\n\", \"testtype\": \"stdin\"}, {\"input\": \"1 2\\n2\\n1 2\\n\", \"output\": \"0\\n\", \"testtype\": \"stdin\"}, {\"input\": \"3 5\\n2\\n1 3\\n2\\n2 4\\n3\\n2 4 5\\n\", \"output\": \"-1\\n\", \"testtype\": \"stdin\"}, {\"input\": \"4 8\\n3\\n1 3 5\\n2\\n1 2\\n3\\n2 4 7\\n4\\n4 6 7 8\\n\", \"output\": \"2\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc304_c", "question_title": "Virus", "question_content": "There are N people numbered 1, 2, \\ldots, N on a two-dimensional plane, and person i is at the point represented by the coordinates (X_i,Y_i).\nPerson 1 has been infected with a virus. The virus spreads to people within a distance of D from an infected person.\nHere, the distance is defined as the Euclidean distance, that is, for two points (a_1, a_2) and (b_1, b_2), the distance between these two points is \\sqrt {(a_1-b_1)^2 + (a_2-b_2)^2}.\nAfter a sufficient amount of time has passed, that is, when all people within a distance of D from person i are infected with the virus if person i is infected, determine whether person i is infected with the virus for each i.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN D\r\nX_1 Y_1\r\nX_2 Y_2\r\n\\vdots\r\nX_N Y_N\n\nOutput\n\nPrint N lines. The i-th line should contain Yes if person i is infected with the virus, and No otherwise.\n\nConstraints\n\n\n- 1 \\leq N, D \\leq 2000\n- -1000 \\leq X_i, Y_i \\leq 1000\n- (X_i, Y_i) \\neq (X_j, Y_j) if i \\neq j.\n- All input values are integers.\n\nSample Input 1\n\n4 5\r\n2 -1\r\n3 1\r\n8 8\r\n0 5\n\nSample Output 1\n\nYes\r\nYes\r\nNo\r\nYes\r\n\nThe distance between person 1 and person 2 is \\sqrt 5, so person 2 gets infected with the virus.\r\nAlso, the distance between person 2 and person 4 is 5, so person 4 gets infected with the virus.\r\nPerson 3 has no one within a distance of 5, so they will not be infected with the virus.\n\nSample Input 2\n\n3 1\r\n0 0\r\n-1000 -1000\r\n1000 1000\n\nSample Output 2\n\nYes\r\nNo\r\nNo\n\nSample Input 3\n\n9 4\r\n3 2\r\n6 -1\r\n1 6\r\n6 5\r\n-2 -3\r\n5 3\r\n2 -3\r\n2 1\r\n2 6\n\nSample Output 3\n\nYes\r\nNo\r\nNo\r\nYes\r\nYes\r\nYes\r\nYes\r\nYes\r\nNo", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"4 5\\n2 -1\\n3 1\\n8 8\\n0 5\\n\", \"output\": \"Yes\\nYes\\nNo\\nYes\\n\", \"testtype\": \"stdin\"}, {\"input\": \"3 1\\n0 0\\n-1000 -1000\\n1000 1000\\n\", \"output\": \"Yes\\nNo\\nNo\\n\", \"testtype\": \"stdin\"}, {\"input\": \"9 4\\n3 2\\n6 -1\\n1 6\\n6 5\\n-2 -3\\n5 3\\n2 -3\\n2 1\\n2 6\\n\", \"output\": \"Yes\\nNo\\nNo\\nYes\\nYes\\nYes\\nYes\\nYes\\nNo\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc304_e", "question_title": "Good Graph", "question_content": "You are given an undirected graph G with N vertices and M edges.\r\nFor i = 1, 2, \\ldots, M, the i-th edge is an undirected edge connecting vertices u_i and v_i.\nA graph with N vertices is called good if the following condition holds for all i = 1, 2, \\ldots, K:\n\n- there is no path connecting vertices x_i and y_i in G.\n\nThe given graph G is good.\nYou are given Q independent questions. Answer all of them.\r\nFor i = 1, 2, \\ldots, Q, the i-th question is as follows.\n\n- Is the graph G^{(i)} obtained by adding an undirected edge connecting vertices p_i and q_i to the given graph G good?\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\nu_1 v_1\r\nu_2 v_2\r\n\\vdots\r\nu_M v_M\r\nK\r\nx_1 y_1\r\nx_2 y_2\r\n\\vdots\r\nx_K y_K\r\nQ\r\np_1 q_1\r\np_2 q_2\r\n\\vdots\r\np_Q q_Q\n\nOutput\n\nPrint Q lines.\r\nFor i = 1, 2, \\ldots, Q, the i-th line should contain the answer to the i-th question: Yes if the graph G^{(i)} is good, and No otherwise.\n\nConstraints\n\n\n- 2 \\leq N \\leq 2 \\times 10^5\n- 0 \\leq M \\leq 2 \\times10^5\n- 1 \\leq u_i, v_i \\leq N\n- 1 \\leq K \\leq 2 \\times 10^5\n- 1 \\leq x_i, y_i \\leq N\n- x_i \\neq y_i\n- i \\neq j \\implies \\lbrace x_i, y_i \\rbrace \\neq \\lbrace x_j, y_j \\rbrace\n- For all i = 1, 2, \\ldots, K, there is no path connecting vertices x_i and y_i.\n- 1 \\leq Q \\leq 2 \\times 10^5\n- 1 \\leq p_i, q_i \\leq N\n- p_i \\neq q_i\n- All input values are integers.\n\nSample Input 1\n\n6 6\r\n1 2\r\n2 3\r\n2 3\r\n3 1\r\n5 4\r\n5 5\r\n3\r\n1 5\r\n2 6\r\n4 3\r\n4\r\n2 5\r\n2 6\r\n5 6\r\n5 4\n\nSample Output 1\n\nNo\r\nNo\r\nYes\r\nYes\r\n\n\n- For the first question, the graph G^{(1)} is not good because it has a path 1 \\rightarrow 2 \\rightarrow 5 connecting vertices x_1 = 1 and y_1 = 5. Therefore, print No.\n- For the second question, the graph G^{(2)} is not good because it has a path 2 \\rightarrow 6 connecting vertices x_2 = 2 and y_2 = 6. Therefore, print No.\n- For the third question, the graph G^{(3)} is good. Therefore, print Yes.\n- For the fourth question, the graph G^{(4)} is good. Therefore, print Yes.\n\nAs seen in this sample input, note that the given graph G may have self-loops or multi-edges.", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"6 6\\n1 2\\n2 3\\n2 3\\n3 1\\n5 4\\n5 5\\n3\\n1 5\\n2 6\\n4 3\\n4\\n2 5\\n2 6\\n5 6\\n5 4\\n\", \"output\": \"No\\nNo\\nYes\\nYes\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc305_e", "question_title": "Art Gallery on Graph", "question_content": "There is a simple undirected graph with N vertices and M edges, where vertices are numbered from 1 to N, and edges are numbered from 1 to M. Edge i connects vertex a_i and vertex b_i.\nK security guards numbered from 1 to K are on some vertices. Guard i is on vertex p_i and has a stamina of h_i. All p_i are distinct.\nA vertex v is said to be guarded when the following condition is satisfied:\n\n- there is at least one guard i such that the distance between vertex v and vertex p_i is at most h_i.\n\nHere, the distance between vertex u and vertex v is the minimum number of edges in the path connecting vertices u and v.\nList all guarded vertices in ascending order.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M K\r\na_1 b_1\r\na_2 b_2\r\n\\vdots\r\na_M b_M\r\np_1 h_1\r\np_2 h_2\r\n\\vdots\r\np_K h_K\n\nOutput\n\nPrint the answer in the following format. Here,\n\n- G is the number of guarded vertices,\n- and v_1, v_2, \\dots, v_G are the vertex numbers of the guarded vertices in ascending order.\n\nG\r\nv_1 v_2 \\dots v_G\n\nConstraints\n\n\n- 1 \\leq N \\leq 2 \\times 10^5\n- 0 \\leq M \\leq \\min \\left(\\frac{N(N-1)}{2}, 2 \\times 10^5 \\right)\n- 1 \\leq K \\leq N\n- 1 \\leq a_i, b_i \\leq N\n- The given graph is simple.\n- 1 \\leq p_i \\leq N\n- All p_i are distinct.\n- 1 \\leq h_i \\leq N\n- All input values are integers.\n\nSample Input 1\n\n5 5 2\r\n1 2\r\n2 3\r\n2 4\r\n3 5\r\n1 5\r\n1 1\r\n5 2\n\nSample Output 1\n\n4\r\n1 2 3 5\r\n\nThe guarded vertices are 1, 2, 3, 5.\r\nThese vertices are guarded because of the following reasons.\n\n- The distance between vertex 1 and vertex p_1 = 1 is 0, which is not greater than h_1 = 1. Thus, vertex 1 is guarded.\n- The distance between vertex 2 and vertex p_1 = 1 is 1, which is not greater than h_1 = 1. Thus, vertex 2 is guarded.\n- The distance between vertex 3 and vertex p_2 = 5 is 1, which is not greater than h_2 = 2. Thus, vertex 3 is guarded.\n- The distance between vertex 5 and vertex p_1 = 1 is 1, which is not greater than h_1 = 1. Thus, vertex 5 is guarded.\n\nSample Input 2\n\n3 0 1\r\n2 3\n\nSample Output 2\n\n1\r\n2\r\n\nThe given graph may have no edges.\n\nSample Input 3\n\n10 10 2\r\n2 1\r\n5 1\r\n6 1\r\n2 4\r\n2 5\r\n2 10\r\n8 5\r\n8 6\r\n9 6\r\n7 9\r\n3 4\r\n8 2\n\nSample Output 3\n\n7\r\n1 2 3 5 6 8 9", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"5 5 2\\n1 2\\n2 3\\n2 4\\n3 5\\n1 5\\n1 1\\n5 2\\n\", \"output\": \"4\\n1 2 3 5\\n\", \"testtype\": \"stdin\"}, {\"input\": \"3 0 1\\n2 3\\n\", \"output\": \"1\\n2\\n\", \"testtype\": \"stdin\"}, {\"input\": \"10 10 2\\n2 1\\n5 1\\n6 1\\n2 4\\n2 5\\n2 10\\n8 5\\n8 6\\n9 6\\n7 9\\n3 4\\n8 2\\n\", \"output\": \"7\\n1 2 3 5 6 8 9\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc308_d", "question_title": "Snuke Maze", "question_content": "We have a grid with H horizontal rows and W vertical columns.\r\nWe denote by (i,j) the cell at the i-th row from the top and j-th column from the left.\r\nEach cell in the grid has a lowercase English letter written on it.  The letter written on (i,j) equals the j-th character of a given string S_i.\nSnuke will repeat moving to an adjacent cell sharing a side to travel from (1,1) to (H,W).\r\nDetermine if there is a path\r\nin which the letters written on the visited cells (including initial (1,1) and final (H,W)) are\r\ns \\rightarrow n \\rightarrow u \\rightarrow k\n\\rightarrow e \\rightarrow s \\rightarrow n \\rightarrow \\dots, in the order of visiting.\r\nHere, a cell (i_1,j_1) is said to be an adjacent cell of (i_2,j_2) sharing a side if and only if |i_1-i_2|+|j_1-j_2| = 1.\nFormally, determine if there is a sequence of cells ((i_1,j_1),(i_2,j_2),\\dots,(i_k,j_k)) such that:\n\n- (i_1,j_1) = (1,1),(i_k,j_k) = (H,W);\n- (i_{t+1},j_{t+1}) is an adjacent cell of (i_t,j_t) sharing a side, for all t\\ (1 \\leq t < k); and\n- the letter written on (i_t,j_t) coincides with the (((t-1) \\bmod 5) + 1)-th character of snuke, for all t\\ (1 \\leq t \\leq k).\n\nInput\n\nThe input is given from Standard Input in the following format:\nH W\r\nS_1\r\nS_2\r\n\\vdots\r\nS_H\n\nOutput\n\nPrint Yes if there is a path satisfying the conditions in the problem statement; print No otherwise.\n\nConstraints\n\n\n- 2\\leq H,W \\leq 500\n- H and W are integers.\n- S_i is a string of length W consisting of lowercase English letters.\n\nSample Input 1\n\n2 3\r\nsns\r\neuk\n\nSample Output 1\n\nYes\r\n\nThe path (1,1) \\rightarrow (1,2)  \\rightarrow (2,2) \\rightarrow (2,3) satisfies the conditions\r\nbecause they have s \\rightarrow n \\rightarrow u \\rightarrow k written on them, in the order of visiting.\n\nSample Input 2\n\n2 2\r\nab\r\ncd\n\nSample Output 2\n\nNo\n\nSample Input 3\n\n5 7\r\nskunsek\r\nnukesnu\r\nukeseku\r\nnsnnesn\r\nuekukku\n\nSample Output 3\n\nYes", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"2 3\\nsns\\neuk\\n\", \"output\": \"Yes\\n\", \"testtype\": \"stdin\"}, {\"input\": \"2 2\\nab\\ncd\\n\", \"output\": \"No\\n\", \"testtype\": \"stdin\"}, {\"input\": \"5 7\\nskunsek\\nnukesnu\\nukeseku\\nnsnnesn\\nuekukku\\n\", \"output\": \"Yes\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc309_d", "question_title": "Add One Edge", "question_content": "We have an undirected graph with (N_1+N_2) vertices and M edges.  For i=1,2,\\ldots,M, the i-th edge connects vertex a_i and vertex b_i.\r\nThe following properties are guaranteed:\n\n- Vertex u and vertex v are connected, for all integers u and v with 1 \\leq u,v \\leq N_1.\n- Vertex u and vertex v are connected, for all integers u and v with N_1+1 \\leq u,v \\leq N_1+N_2.\n- Vertex 1 and vertex (N_1+N_2) are disconnected.\n\nConsider performing the following operation exactly once:\n\n- choose an integer u with 1 \\leq u \\leq N_1 and an integer v with N_1+1 \\leq v \\leq N_1+N_2, and add an edge connecting vertex u and vertex v.\n\nWe can show that vertex 1 and vertex (N_1+N_2) are always connected in the resulting graph; so let d be the minimum length (number of edges) of a path between vertex 1 and vertex (N_1+N_2).  \nFind the maximum possible d resulting from adding an appropriate edge to add.\n\nDefinition of \"connected\"\r\nTwo vertices u and v of an undirected graph are said to be connected if and only if there is a path between vertex u and vertex v.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN_1 N_2 M\r\na_1 b_1\r\n\\vdots\r\na_M b_M\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- 1 \\leq N_1,N_2 \\leq 1.5 \\times 10^5\n- 0 \\leq M \\leq 3 \\times 10^5\n- 1 \\leq a_i \\leq b_i \\leq N_1+N_2\n- (a_i,b_i) \\neq (a_j,b_j) if i \\neq j.\n- Vertex u and vertex v are connected for all integers u and v such that 1 \\leq u,v \\leq N_1.\n- Vertex u and vertex v are connected for all integers u and v such that N_1+1 \\leq u,v \\leq N_1+N_2.\n- Vertex 1 and vertex (N_1+N_2) are disconnected.\n- All input values are integers.\n\nSample Input 1\n\n3 4 6\r\n1 2\r\n2 3\r\n4 5\r\n4 6\r\n1 3\r\n6 7\n\nSample Output 1\n\n5\r\n\nIf we set u=2 and v=5, the operation yields d=5, which is the maximum possible.\n\nSample Input 2\n\n7 5 20\r\n10 11\r\n4 5\r\n10 12\r\n1 2\r\n1 5\r\n5 6\r\n2 4\r\n3 5\r\n9 10\r\n2 5\r\n1 4\r\n11 12\r\n9 12\r\n8 9\r\n5 7\r\n3 7\r\n3 6\r\n3 4\r\n8 12\r\n9 11\n\nSample Output 2\n\n4", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"3 4 6\\n1 2\\n2 3\\n4 5\\n4 6\\n1 3\\n6 7\\n\", \"output\": \"5\\n\", \"testtype\": \"stdin\"}, {\"input\": \"7 5 20\\n10 11\\n4 5\\n10 12\\n1 2\\n1 5\\n5 6\\n2 4\\n3 5\\n9 10\\n2 5\\n1 4\\n11 12\\n9 12\\n8 9\\n5 7\\n3 7\\n3 6\\n3 4\\n8 12\\n9 11\\n\", \"output\": \"4\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc309_e", "question_title": "Family and Insurance", "question_content": "There is a family consisting of person 1, person 2, \\ldots, and person N.  For i\\geq 2, person i's parent is person p_i.\nThey bought insurance M times.  For i=1,2,\\ldots,M, person x_i bought the i-th insurance, which covers that person and their descendants in the next y_i generations.  \nHow many people are covered by at least one insurance?\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\np_2 \\ldots p_N\r\nx_1 y_1\r\n\\vdots\r\nx_M y_M\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- 2 \\leq N \\leq 3 \\times 10^5\n- 1 \\leq M \\leq 3 \\times 10^5\n- 1 \\leq p_i \\leq i-1\n- 1 \\leq x_i \\leq N\n- 1 \\leq y_i \\leq 3 \\times 10^5\n- All input values are integers.\n\nSample Input 1\n\n7 3\r\n1 2 1 3 3 3\r\n1 1\r\n1 2\r\n4 3\n\nSample Output 1\n\n4\r\n\nThe 1-st insurance covers people 1, 2, and 4, because person 1's 1-st generation descendants are people 2 and 4.\r\nThe 2-nd insurance covers people 1, 2, 3, and 4, because person 1's 1-st generation descendants are people 2 and 4, and person 1's 2-nd generation descendant is person 3.\r\nThe 3-rd insurance covers person 4, because person 4 has no 1-st, 2-nd, or 3-rd descendants.  \nTherefore, four people, people 1, 2, 3, and 4, are covered by at least one insurance.\n\nSample Input 2\n\n10 10\r\n1 1 3 1 2 3 3 5 7\r\n2 1\r\n5 1\r\n4 3\r\n6 3\r\n2 1\r\n7 3\r\n9 2\r\n1 2\r\n6 2\r\n8 1\n\nSample Output 2\n\n10", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"7 3\\n1 2 1 3 3 3\\n1 1\\n1 2\\n4 3\\n\", \"output\": \"4\\n\", \"testtype\": \"stdin\"}, {\"input\": \"10 10\\n1 1 3 1 2 3 3 5 7\\n2 1\\n5 1\\n4 3\\n6 3\\n2 1\\n7 3\\n9 2\\n1 2\\n6 2\\n8 1\\n\", \"output\": \"10\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc311_c", "question_title": "Find it!", "question_content": "There is a directed graph with N vertices and N edges.\r\nThe i-th edge goes from vertex i to vertex A_i. (The constraints guarantee that i \\neq A_i.)\r\nFind a directed cycle without the same vertex appearing multiple times.\r\nIt can be shown that a solution exists under the constraints of this problem.\nNotes\nThe sequence of vertices B = (B_1, B_2, \\dots, B_M) is called a directed cycle when all of the following conditions are satisfied:\n\n- M \\geq 2\n- The edge from vertex B_i to vertex B_{i+1} exists. (1 \\leq i \\leq M-1)\n- The edge from vertex B_M to vertex B_1 exists.\n- If i \\neq j, then B_i \\neq B_j.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN\r\nA_1 A_2 \\dots A_N\n\nOutput\n\nPrint a solution in the following format:\nM\r\nB_1 B_2 \\dots B_M\r\n\nM is the number of vertices, and B_i is the i-th vertex in the directed cycle.\r\nThe following conditions must be satisfied:\n\n- 2 \\le M\n- B_{i+1} = A_{B_i} ( 1 \\le i \\le M-1 )\n- B_{1} = A_{B_M}\n- B_i \\neq B_j ( i \\neq j )\n\nIf multiple solutions exist, any of them will be accepted.\n\nConstraints\n\n\n- All input values are integers.\n- 2 \\le N \\le 2 \\times 10^5\n- 1 \\le A_i \\le N\n- A_i \\neq i\n\nSample Input 1\n\n7\r\n6 7 2 1 3 4 5\n\nSample Output 1\n\n4\r\n7 5 3 2\r\n\n7 \\rightarrow 5 \\rightarrow 3 \\rightarrow 2 \\rightarrow 7 is indeed a directed cycle.\nHere is the graph corresponding to this input:\n\nHere are other acceptable outputs:\n4\r\n2 7 5 3\r\n\n3\r\n4 1 6\r\n\nNote that the graph may not be connected.\n\nSample Input 2\n\n2\r\n2 1\n\nSample Output 2\n\n2\r\n1 2\r\n\nThis case contains both of the edges 1 \\rightarrow 2 and 2 \\rightarrow 1.\r\nIn this case, 1 \\rightarrow 2 \\rightarrow 1 is indeed a directed cycle.\nHere is the graph corresponding to this input, where 1 \\leftrightarrow 2 represents the existence of both 1 \\rightarrow 2 and 2 \\rightarrow 1:\n\nSample Input 3\n\n8\r\n3 7 4 7 3 3 8 2\n\nSample Output 3\n\n3\r\n2 7 8\r\n\nHere is the graph corresponding to this input:", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"7\\n6 7 2 1 3 4 5\\n\", \"output\": \"4\\n7 5 3 2\\n\", \"testtype\": \"stdin\"}, {\"input\": \"2\\n2 1\\n\", \"output\": \"2\\n1 2\\n\", \"testtype\": \"stdin\"}, {\"input\": \"8\\n3 7 4 7 3 3 8 2\\n\", \"output\": \"3\\n2 7 8\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc311_d", "question_title": "Grid Ice Floor", "question_content": "There is an N \\times M grid and a player standing on it.\r\nLet (i,j) denote the square at the i-th row from the top and j-th column from the left of this grid.\r\nEach square of this grid is ice or rock, which is represented by N strings S_1,S_2,\\dots,S_N of length M as follows:\n\n- if the j-th character of S_i is ., square (i,j) is ice;\n- if the j-th character of S_i is #, square (i,j) is rock.\n\nThe outer periphery of this grid (all squares in the 1-st row, N-th row, 1-st column, M-th column) is rock.\nInitially, the player rests on the square (2,2), which is ice.\r\nThe player can make the following move zero or more times.\n\n- First, specify the direction of movement: up, down, left, or right.\n- Then, keep moving in that direction until the player bumps against a rock. Formally, keep doing the following:\n- if the next square in the direction of movement is ice, go to that square and keep moving;\n- if the next square in the direction of movement is rock, stay in the current square and stop moving.\n\n\n\nFind the number of ice squares the player can touch (pass or rest on).\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\nS_1\r\nS_2\r\n\\vdots\r\nS_N\n\nOutput\n\nPrint the answer as an integer.\n\nConstraints\n\n\n- 3 \\le N,M \\le 200\n- S_i is a string of length M consisting of # and ..\n- Square (i, j) is rock if i=1, i=N, j=1, or j=M.\n- Square (2,2) is ice.\n\nSample Input 1\n\n6 6\r\n######\r\n#....#\r\n#.#..#\r\n#..#.#\r\n#....#\r\n######\n\nSample Output 1\n\n12\r\n\nFor instance, the player can rest on (5,5) by moving as follows:\n\n- (2,2) \\rightarrow (5,2) \\rightarrow (5,5).\n\nThe player can pass (2,4) by moving as follows:\n\n- (2,2) \\rightarrow (2,5), passing (2,4) in the process.\n\nThe player cannot pass or rest on (3,4).\n\nSample Input 2\n\n21 25\r\n#########################\r\n#..............###...####\r\n#..............#..#...###\r\n#........###...#...#...##\r\n#........#..#..#........#\r\n#...##...#..#..#...#....#\r\n#..#..#..###...#..#.....#\r\n#..#..#..#..#..###......#\r\n#..####..#..#...........#\r\n#..#..#..###............#\r\n#..#..#.................#\r\n#........##.............#\r\n#.......#..#............#\r\n#..........#....#.......#\r\n#........###...##....#..#\r\n#..........#..#.#...##..#\r\n#.......#..#....#..#.#..#\r\n##.......##.....#....#..#\r\n###.............#....#..#\r\n####.................#..#\r\n#########################\n\nSample Output 2\n\n215", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"6 6\\n######\\n#....#\\n#.#..#\\n#..#.#\\n#....#\\n######\\n\", \"output\": \"12\\n\", \"testtype\": \"stdin\"}, {\"input\": \"21 25\\n#########################\\n#..............###...####\\n#..............#..#...###\\n#........###...#...#...##\\n#........#..#..#........#\\n#...##...#..#..#...#....#\\n#..#..#..###...#..#.....#\\n#..#..#..#..#..###......#\\n#..####..#..#...........#\\n#..#..#..###............#\\n#..#..#.................#\\n#........##.............#\\n#.......#..#............#\\n#..........#....#.......#\\n#........###...##....#..#\\n#..........#..#.#...##..#\\n#.......#..#....#..#.#..#\\n##.......##.....#....#..#\\n###.............#....#..#\\n####.................#..#\\n#########################\\n\", \"output\": \"215\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc313_b", "question_title": "Who is Saikyo?", "question_content": "There are N competitive programmers numbered person 1, person 2, \\ldots, and person N.\nThere is a relation called superiority between the programmers.  For all pairs of distinct programmers (person X, person Y), exactly one of the following two relations holds: \"person X is stronger than person Y\" or \"person Y is stronger than person X.\"\nThe superiority is transitive.  In other words, for all triplets of distinct programmers (person X, person Y, person Z), it holds that:\n\n- if person X is stronger than person Y and person Y is stronger than person Z, then person X is stronger than person Z.\n\nA person X is said to be the strongest programmer if person X is stronger than person Y for all people Y other than person X.  (Under the constraints above, we can prove that there is always exactly one such person.)  \nYou have M pieces of information on their superiority.  The i-th of them is that \"person A_i is stronger than person B_i.\"\nCan you determine the strongest programmer among the N based on the information?\nIf you can, print the person's number.  Otherwise, that is, if there are multiple possible strongest programmers, print -1.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\nA_1 B_1\nA_2 B_2\n\\vdots\nA_M B_M\n\nOutput\n\nIf you can uniquely determine the strongest programmer, print the person's number; otherwise, print -1.\n\nConstraints\n\n\n- 2 \\leq N \\leq 50\n- 0 \\leq M \\leq \\frac{N(N-1)}{2}\n- 1 \\leq A_i, B_i \\leq N\n- A_i \\neq B_i\n- If i \\neq j, then (A_i, B_i) \\neq (A_j, B_j).\n- There is at least one way to determine superiorities for all pairs of distinct programmers, that is consistent with the given information.\n\nSample Input 1\n\n3 2\n1 2\n2 3\n\nSample Output 1\n\n1\n\nYou have two pieces of information: \"person 1 is stronger than person 2\" and \"person 2 is stronger than person 3.\"\nBy the transitivity, you can also infer that \"person 1 is stronger than person 3,\" so person 1 is the strongest programmer.\n\nSample Input 2\n\n3 2\n1 3\n2 3\n\nSample Output 2\n\n-1\n\nBoth person 1 and person 2 may be the strongest programmer.  Since you cannot uniquely determine which is the strongest, you should print -1.\n\nSample Input 3\n\n6 6\n1 6\n6 5\n6 2\n2 3\n4 3\n4 2\n\nSample Output 3\n\n-1", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"3 2\\n1 2\\n2 3\\n\", \"output\": \"1\\n\", \"testtype\": \"stdin\"}, {\"input\": \"3 2\\n1 3\\n2 3\\n\", \"output\": \"-1\\n\", \"testtype\": \"stdin\"}, {\"input\": \"6 6\\n1 6\\n6 5\\n6 2\\n2 3\\n4 3\\n4 2\\n\", \"output\": \"-1\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc315_e", "question_title": "Prerequisites", "question_content": "We have N books numbered 1 to N.\r\nBook i assumes that you have read C_i books, the j-th of which is book P_{i,j}: you must read all these C_i books before reading book i.\r\nHere, you can read all the books in some order.\nYou are trying to read the minimum number of books required to read book 1.\r\nPrint the numbers of the books you must read excluding book 1 in the order they should be read. Under this condition, the set of books to read is uniquely determined.\r\nIf there are multiple reading orders that satisfy the condition, you may print any of them.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN\r\nC_1 P_{1,1} \\ldots P_{1,C_1}\r\nC_2 P_{2,1} \\ldots P_{2,C_2}\r\n\\vdots\r\nC_N P_{N,1} \\ldots P_{N,C_N}\n\nOutput\n\nPrint the numbers of the books you must read to read book 1 in the order they should be read, with spaces in between.\n\nConstraints\n\n\n- 2 \\leq N \\leq 2 \\times 10^5\n- 0 \\leq C_i < N\n- \\sum_{i=1}^{N} C_i \\leq 2 \\times 10^5\n- C_1 \\geq 1\n- 1 \\leq P_{i,j} \\leq N\n- P_{i,j} \\neq P_{i,k} for 1 \\leq j < k \\leq C_i.\n- It is possible to read all the books.\n\nSample Input 1\n\n6\r\n3 2 3 4\r\n2 3 5\r\n0\r\n1 5\r\n0\r\n0\n\nSample Output 1\n\n5 3 4 2\r\n\nTo read book 1, you must read books 2,3,4; to read book 2, you must read books 3,5; to read book 4, you must read book 5. To read books 3,5,6, you do not have to read any other books.\nFor example, if you read books 5,3,4,2 in this order, you can read book 1. This is a correct answer, because you will never be able to read book 1 with three or fewer books read. As another example, reading books 3,5,4,2 in this order also allows you to read book 1 with 4 books read.\n\nSample Input 2\n\n6\r\n1 2\r\n1 3\r\n1 4\r\n1 5\r\n1 6\r\n0\n\nSample Output 2\n\n6 5 4 3 2\n\nSample Input 3\n\n8\r\n1 5\r\n1 6\r\n1 7\r\n1 8\r\n0\r\n0\r\n0\r\n0\n\nSample Output 3\n\n5", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"6\\n3 2 3 4\\n2 3 5\\n0\\n1 5\\n0\\n0\\n\", \"output\": \"5 3 4 2\\n\", \"testtype\": \"stdin\"}, {\"input\": \"6\\n1 2\\n1 3\\n1 4\\n1 5\\n1 6\\n0\\n\", \"output\": \"6 5 4 3 2\\n\", \"testtype\": \"stdin\"}, {\"input\": \"8\\n1 5\\n1 6\\n1 7\\n1 8\\n0\\n0\\n0\\n0\\n\", \"output\": \"5\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc318_d", "question_title": "General Weighted Max Matching", "question_content": "You are given a weighted undirected complete graph with N vertices numbered from 1 to N. The edge connecting vertices i and j (i< j) has a weight of D_{i,j}.\nWhen choosing some number of edges under the following condition, find the maximum possible total weight of the chosen edges.\n\n- The endpoints of the chosen edges are pairwise distinct.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN \r\nD_{1,2} D_{1,3} \\ldots D_{1,N}\r\nD_{2,3} \\ldots D_{2,N}\r\n\\vdots\r\nD_{N-1,N}\n\nOutput\n\nPrint the answer as an integer.\n\nConstraints\n\n\n- 2\\leq N\\leq 16\n- 1\\leq D_{i,j} \\leq 10^9\n- All input values are integers.\n\nSample Input 1\n\n4\r\n1 5 4\r\n7 8\r\n6\n\nSample Output 1\n\n13\r\n\nIf you choose the edge connecting vertices 1 and 3, and the edge connecting vertices 2 and 4, the total weight of the edges is 5+8=13.\nIt can be shown that this is the maximum achievable value.\n\nSample Input 2\n\n3\r\n1 2\r\n3\n\nSample Output 2\n\n3\r\n\nN can be odd.\n\nSample Input 3\n\n16\r\n5 6 5 2 1 7 9 7 2 5 5 2 4 7 6\r\n8 7 7 9 8 1 9 6 10 8 8 6 10 3\r\n10 5 8 1 10 7 8 4 8 6 5 1 10\r\n7 4 1 4 5 4 5 10 1 5 1 2\r\n2 9 9 7 6 2 2 8 3 5 2\r\n9 10 3 1 1 2 10 7 7 5\r\n10 6 1 8 9 3 2 4 2\r\n10 10 8 9 2 10 7 9\r\n5 8 8 7 5 8 2\r\n4 2 2 6 8 3\r\n2 7 3 10 3\r\n5 7 10 3\r\n8 5 7\r\n9 1\r\n4\n\nSample Output 3\n\n75", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"4\\n1 5 4\\n7 8\\n6\\n\", \"output\": \"13\\n\", \"testtype\": \"stdin\"}, {\"input\": \"3\\n1 2\\n3\\n\", \"output\": \"3\\n\", \"testtype\": \"stdin\"}, {\"input\": \"16\\n5 6 5 2 1 7 9 7 2 5 5 2 4 7 6\\n8 7 7 9 8 1 9 6 10 8 8 6 10 3\\n10 5 8 1 10 7 8 4 8 6 5 1 10\\n7 4 1 4 5 4 5 10 1 5 1 2\\n2 9 9 7 6 2 2 8 3 5 2\\n9 10 3 1 1 2 10 7 7 5\\n10 6 1 8 9 3 2 4 2\\n10 10 8 9 2 10 7 9\\n5 8 8 7 5 8 2\\n4 2 2 6 8 3\\n2 7 3 10 3\\n5 7 10 3\\n8 5 7\\n9 1\\n4\\n\", \"output\": \"75\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc320_d", "question_title": "Relative Position", "question_content": "There are N people numbered 1 to N on a coordinate plane.\r\nPerson 1 is at the origin.\nYou are given M pieces of information in the following form:\n\n- From person A_i's perspective, person B_i is X_i units away in the positive x-direction and Y_i units away in the positive y-direction.\n\nDetermine the coordinates of each person. If the coordinates of a person cannot be uniquely determined, report that fact.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\nA_1 B_1 X_1 Y_1\r\n\\vdots\r\nA_M B_M X_M Y_M\n\nOutput\n\nPrint N lines.\r\nIf the coordinates of person i cannot be uniquely determined, the i-th line should contain undecidable.\r\nIf they can be uniquely determined as (s_i,t_i), the i-th line should contain s_i and t_i in this order, separated by a space.\n\nConstraints\n\n\n- 1 \\leq N \\leq 2\\times 10^5\n- 0 \\leq M \\leq 2\\times 10^5\n- 1\\leq A_i,  B_i \\leq N\n- A_i \\neq B_i\n- -10^9 \\leq X_i,Y_i \\leq 10^9\n- All input values are integers.\n- The given information is consistent.\n\nSample Input 1\n\n3 2\r\n1 2 2 1\r\n1 3 -1 -2\n\nSample Output 1\n\n0 0\r\n2 1\r\n-1 -2\r\n\nThe figure below shows the positional relationship of the three people.\n\nSample Input 2\n\n3 2\r\n2 1 -2 -1\r\n2 3 -3 -3\n\nSample Output 2\n\n0 0\r\n2 1\r\n-1 -2\r\n\nThe figure below shows the positional relationship of the three people.\n\nSample Input 3\n\n5 7\r\n1 2 0 0\r\n1 2 0 0\r\n2 3 0 0\r\n3 1 0 0\r\n2 1 0 0\r\n3 2 0 0\r\n4 5 0 0\n\nSample Output 3\n\n0 0\r\n0 0\r\n0 0\r\nundecidable\r\nundecidable\r\n\nThe same piece of information may be given multiple times, and multiple people may be at the same coordinates.", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"3 2\\n1 2 2 1\\n1 3 -1 -2\\n\", \"output\": \"0 0\\n2 1\\n-1 -2\\n\", \"testtype\": \"stdin\"}, {\"input\": \"3 2\\n2 1 -2 -1\\n2 3 -3 -3\\n\", \"output\": \"0 0\\n2 1\\n-1 -2\\n\", \"testtype\": \"stdin\"}, {\"input\": \"5 7\\n1 2 0 0\\n1 2 0 0\\n2 3 0 0\\n3 1 0 0\\n2 1 0 0\\n3 2 0 0\\n4 5 0 0\\n\", \"output\": \"0 0\\n0 0\\n0 0\\nundecidable\\nundecidable\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc325_c", "question_title": "Sensors", "question_content": "There are zero or more sensors placed on a grid of H rows and W columns. Let (i, j) denote the square in the i-th row from the top and the j-th column from the left. \r\nWhether each square contains a sensor is given by the strings S_1, S_2, \\ldots, S_H, each of length W. (i, j) contains a sensor if and only if the j-th character of S_i is #.\r\nThese sensors interact with other sensors in the squares horizontally, vertically, or diagonally adjacent to them and operate as one sensor.\r\nHere, a cell (x, y) and a cell (x', y') are said to be horizontally, vertically, or diagonally adjacent if and only if \\max(|x-x'|,|y-y'|) = 1.\r\nNote that if sensor A interacts with sensor B and sensor A interacts with sensor C, then sensor B and sensor C also interact.\nConsidering the interacting sensors as one sensor, find the number of sensors on this grid.\n\nInput\n\nThe input is given from Standard Input in the following format:\nH W\r\nS_1\r\nS_2\r\n\\vdots\r\nS_H\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- 1 \\leq H, W \\leq 1000\n- H and W are integers.\n- S_i is a string of length W where each character is # or ..\n\nSample Input 1\n\n5 6\r\n.##...\r\n...#..\r\n....##\r\n#.#...\r\n..#...\n\nSample Output 1\n\n3\r\n\nWhen considering the interacting sensors as one sensor, the following three sensors exist:\n\n- The interacting sensors at (1,2),(1,3),(2,4),(3,5),(3,6)\n- The sensor at (4,1)\n- The interacting sensors at (4,3),(5,3)\n\nSample Input 2\n\n3 3\r\n#.#\r\n.#.\r\n#.#\n\nSample Output 2\n\n1\n\nSample Input 3\n\n4 2\r\n..\r\n..\r\n..\r\n..\n\nSample Output 3\n\n0\n\nSample Input 4\n\n5 47\r\n.#..#..#####..#...#..#####..#...#...###...#####\r\n.#.#...#.......#.#...#......##..#..#...#..#....\r\n.##....#####....#....#####..#.#.#..#......#####\r\n.#.#...#........#....#......#..##..#...#..#....\r\n.#..#..#####....#....#####..#...#...###...#####\n\nSample Output 4\n\n7", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"5 6\\n.##...\\n...#..\\n....##\\n#.#...\\n..#...\\n\", \"output\": \"3\\n\", \"testtype\": \"stdin\"}, {\"input\": \"3 3\\n#.#\\n.#.\\n#.#\\n\", \"output\": \"1\\n\", \"testtype\": \"stdin\"}, {\"input\": \"4 2\\n..\\n..\\n..\\n..\\n\", \"output\": \"0\\n\", \"testtype\": \"stdin\"}, {\"input\": \"5 47\\n.#..#..#####..#...#..#####..#...#...###...#####\\n.#.#...#.......#.#...#......##..#..#...#..#....\\n.##....#####....#....#####..#.#.#..#......#####\\n.#.#...#........#....#......#..##..#...#..#....\\n.#..#..#####....#....#####..#...#...###...#####\\n\", \"output\": \"7\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc327_d", "question_title": "Good Tuple Problem", "question_content": "A pair of sequences of length M consisting of positive integers at most N, (S, T) = ((S_1, S_2, \\dots, S_M), (T_1, T_2, \\dots, T_M)), is said to be a good pair of sequences when (S, T) satisfies the following condition.\n\n- There exists a sequence X = (X_1, X_2, \\dots, X_N) of length N consisting of 0 and 1 that satisfies the following condition:\n- X_{S_i} \\neq X_{T_i} for each i=1, 2, \\dots, M.\n\n\n\nYou are given a pair of sequences of length M consisting of positive integers at most N: (A, B) = ((A_1, A_2, \\dots, A_M), (B_1, B_2, \\dots, B_M)). If (A, B) is a good pair of sequences, print Yes; otherwise, print No.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\nA_1 A_2 \\dots A_M\r\nB_1 B_2 \\dots B_M\n\nOutput\n\nIf (A, B) is a good pair of sequences, print Yes; otherwise, print No.\n\nConstraints\n\n\n- 1 \\leq N, M \\leq 2 \\times 10^5\n- 1 \\leq A_i, B_i \\leq N\n- All input values are integers.\n\nSample Input 1\n\n3 2\r\n1 2\r\n2 3\n\nSample Output 1\n\nYes\r\n\nIf we set X=(0,1,0), then X is a sequence of length N consisting of 0 and 1 that satisfies X_{A_1} \\neq X_{B_1} and X_{A_2} \\neq X_{B_2}.\r\nThus, (A, B) satisfies the condition of being a good pair of sequences.\n\nSample Input 2\n\n3 3\r\n1 2 3\r\n2 3 1\n\nSample Output 2\n\nNo\r\n\nNo sequence X satisfies the condition, so (A, B) is not a good pair of sequences.\n\nSample Input 3\n\n10 1\r\n1\r\n1\n\nSample Output 3\n\nNo\n\nSample Input 4\n\n7 8\r\n1 6 2 7 5 4 2 2\r\n3 2 7 2 1 2 3 3\n\nSample Output 4\n\nYes", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"3 2\\n1 2\\n2 3\\n\", \"output\": \"Yes\\n\", \"testtype\": \"stdin\"}, {\"input\": \"3 3\\n1 2 3\\n2 3 1\\n\", \"output\": \"No\\n\", \"testtype\": \"stdin\"}, {\"input\": \"10 1\\n1\\n1\\n\", \"output\": \"No\\n\", \"testtype\": \"stdin\"}, {\"input\": \"7 8\\n1 6 2 7 5 4 2 2\\n3 2 7 2 1 2 3 3\\n\", \"output\": \"Yes\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc338_d", "question_title": "Island Tour", "question_content": "The AtCoder Archipelago consists of N islands connected by N bridges.\nThe islands are numbered from 1 to N, and the i-th bridge (1\\leq i\\leq N-1) connects islands i and i+1 bidirectionally, while the N-th bridge connects islands N and 1 bidirectionally.\nThere is no way to travel between islands other than crossing the bridges.\nOn the islands, a tour that starts from island X_1 and visits islands X_2, X_3, \\dots, X_M in order is regularly conducted.\nThe tour may pass through islands other than those being visited, and the total number of times bridges are crossed during the tour is defined as the length of the tour.\nMore precisely, a tour is a sequence of l+1 islands a_0, a_1, \\dots, a_l that satisfies all the following conditions, and its length is defined as l:\n\n- For all j\\ (0\\leq j\\leq l-1), islands a_j and a_{j+1} are directly connected by a bridge.\n- There are some 0 = y_1 < y_2 < \\dots < y_M = l such that for all k\\ (1\\leq k\\leq M), a_{y_k} = X_k.\n\nDue to financial difficulties, the islands will close one bridge to reduce maintenance costs.\nDetermine the minimum possible length of the tour when the bridge to be closed is chosen optimally.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\nX_1 X_2 \\dots X_M\n\nOutput\n\nPrint the answer as an integer.\n\nConstraints\n\n\n- 3\\leq N \\leq 2\\times 10^5\n- 2\\leq M \\leq 2\\times 10^5\n- 1\\leq X_k\\leq N\n- X_k\\neq X_{k+1}\\ (1\\leq k\\leq M-1)\n- All input values are integers.\n\nSample Input 1\n\n3 3\n1 3 2\n\nSample Output 1\n\n2\n\n\n- If the first bridge is closed: By taking the sequence of islands (a_0, a_1, a_2) = (1, 3, 2), it is possible to visit islands 1, 3, 2 in order, and a tour of length 2 can be conducted. There is no shorter tour.\n- If the second bridge is closed: By taking the sequence of islands (a_0, a_1, a_2, a_3) = (1, 3, 1, 2), it is possible to visit islands 1, 3, 2 in order, and a tour of length 3 can be conducted. There is no shorter tour.\n- If the third bridge is closed: By taking the sequence of islands (a_0, a_1, a_2, a_3) = (1, 2, 3, 2), it is possible to visit islands 1, 3, 2 in order, and a tour of length 3 can be conducted. There is no shorter tour.\n\nTherefore, the minimum possible length of the tour when the bridge to be closed is chosen optimally is 2.\nThe following figure shows, from left to right, the cases when bridges 1, 2, 3 are closed, respectively. The circles with numbers represent islands, the lines connecting the circles represent bridges, and the blue arrows represent the shortest tour routes.\n\nSample Input 2\n\n4 5\n2 4 2 4 2\n\nSample Output 2\n\n8\n\nThe same island may appear multiple times in X_1, X_2, \\dots, X_M.\n\nSample Input 3\n\n163054 10\n62874 19143 77750 111403 29327 56303 6659 18896 64175 26369\n\nSample Output 3\n\n390009", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 3\\n1 3 2\\n\", \"output\": \"2\\n\", \"testtype\": \"stdin\"}, {\"input\": \"4 5\\n2 4 2 4 2\\n\", \"output\": \"8\\n\", \"testtype\": \"stdin\"}, {\"input\": \"163054 10\\n62874 19143 77750 111403 29327 56303 6659 18896 64175 26369\\n\", \"output\": \"390009\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc339_d", "question_title": "Synchronized Players", "question_content": "There is an N \\times N grid, where each cell is either empty or contains an obstacle. Let (i, j) denote the cell at the i-th row from the top and the j-th column from the left.\nThere are also two players on distinct empty cells of the grid. The information about each cell is given as N strings S_1, S_2, \\ldots, S_N of length N, in the following format:\n\n- \r\nIf the j-th character of S_i is P, then (i, j) is an empty cell with a player on it.\n\n- \r\nIf the j-th character of S_i is ., then (i, j) is an empty cell without a player.\n\n- \r\nIf the j-th character of S_i is #, then (i, j) contains an obstacle.\n\n\nFind the minimum number of moves required to bring the two players to the same cell by repeating the following operation. If it is impossible to bring the two players to the same cell by repeating the operation, print -1.\n\n- Choose one of the four directions: up, down, left, or right. Then, each player attempts to move to the adjacent cell in that direction. Each player moves if the destination cell exists and is empty, and does not move otherwise.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN\r\nS_1\r\nS_2\r\n\\vdots\r\nS_N\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- N is an integer between 2 and 60, inclusive.\n- S_i is a string of length N consisting of P, ., and #.\n- There are exactly two pairs (i, j) where the j-th character of S_i is P.\n\nSample Input 1\n\n5\r\n....#\r\n#..#.\r\n.P...\r\n..P..\r\n....#\n\nSample Output 1\n\n3\r\n\nLet us call the player starting at (3, 2) Player 1 and the player starting at (4, 3) Player 2.\nFor example, doing the following brings the two players to the same cell in three moves:\n\n- \r\nChoose left. Player 1 moves to (3, 1), and Player 2 moves to (4, 2).\n\n- \r\nChoose up. Player 1 does not move, and Player 2 moves to (3, 2).\n\n- \r\nChoose left. Player 1 does not move, and Player 2 moves to (3, 1).\n\nSample Input 2\n\n2\r\nP#\r\n#P\n\nSample Output 2\n\n-1\n\nSample Input 3\n\n10\r\n..........\r\n..........\r\n..........\r\n..........\r\n....P.....\r\n.....P....\r\n..........\r\n..........\r\n..........\r\n..........\n\nSample Output 3\n\n10", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"5\\n....#\\n#..#.\\n.P...\\n..P..\\n....#\\n\", \"output\": \"3\\n\", \"testtype\": \"stdin\"}, {\"input\": \"2\\nP#\\n#P\\n\", \"output\": \"-1\\n\", \"testtype\": \"stdin\"}, {\"input\": \"10\\n..........\\n..........\\n..........\\n..........\\n....P.....\\n.....P....\\n..........\\n..........\\n..........\\n..........\\n\", \"output\": \"10\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc375_g", "question_title": "Road Blocked 2", "question_content": "In the nation of AtCoder, there are N cities numbered 1 to N, and M roads numbered 1 to M.\r\nRoad i connects cities A_i and B_i bidirectionally and has a length of C_i.\nFor each i = 1, \\ldots, M, determine whether the following two values are different.\n\n- The shortest distance from city 1 to city N when all roads are passable\n- The shortest distance from city 1 to city N when the M - 1 roads other than road i are passable\n\nIf city N can be reached from city 1 in one of these cases but not the other, the two values are considered different.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\nA_1 B_1 C_1\r\n\\vdots\r\nA_M B_M C_M\n\nOutput\n\nPrint M lines. The i-th line should contain Yes if the shortest distance from city 1 to city N when all roads are passable is different from the shortest distance when the M - 1 roads other than road i are passable, and No otherwise.\nIf city N can be reached from city 1 in one of these cases but not the other, the two values are considered different.\n\nConstraints\n\n\n- 2 \\leq N \\leq 2 \\times 10^5\n- 1 \\leq M \\leq 2 \\times 10^5\n- 1 \\leq A_i < B_i \\leq N\n- All pairs (A_i, B_i) are distinct.\n- 1 \\leq C_i \\leq 10^9\n- City N can be reached from city 1 when all roads are passable.\n- All input values are integers.\n\nSample Input 1\n\n3 3\r\n1 2 5\r\n1 3 10\r\n2 3 6\n\nSample Output 1\n\nNo\r\nYes\r\nNo\r\n\nWhen all roads are passable, the shortest distance from city 1 to city 3 is 10.\n\n- When the two roads other than road 1 are passable, the shortest distance is 10.\n- When the two roads other than road 2 are passable, the shortest distance is 11.\n- When the two roads other than road 3 are passable, the shortest distance is 10.\n\nSample Input 2\n\n4 6\r\n2 3 1\r\n2 4 1\r\n3 4 1\r\n1 2 1\r\n1 3 1\r\n1 4 1\n\nSample Output 2\n\nNo\r\nNo\r\nNo\r\nNo\r\nNo\r\nYes\r\n\nWhen all roads are passable, the shortest distance from city 1 to city 4 is 1.\nWhen the five roads other than road 6 are passable, the shortest distance is 2.\n\nSample Input 3\n\n2 1\r\n1 2 1\n\nSample Output 3\n\nYes\r\n\nWhen the zero roads other than road 1 are passable, city 2 cannot be reached from city 1.", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 3\\n1 2 5\\n1 3 10\\n2 3 6\\n\", \"output\": \"No\\nYes\\nNo\\n\", \"testtype\": \"stdin\"}, {\"input\": \"4 6\\n2 3 1\\n2 4 1\\n3 4 1\\n1 2 1\\n1 3 1\\n1 4 1\\n\", \"output\": \"No\\nNo\\nNo\\nNo\\nNo\\nYes\\n\", \"testtype\": \"stdin\"}, {\"input\": \"2 1\\n1 2 1\\n\", \"output\": \"Yes\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc376_d", "question_title": "Cycle", "question_content": "There is a simple directed graph with N vertices numbered from 1 to N and M edges. The i-th edge (1 \\leq i \\leq M) is a directed edge from vertex a_i to vertex b_i.\r\nDetermine whether there exists a cycle that contains vertex 1, and if it exists, find the minimum number of edges among such cycles.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\na_1 b_1\r\na_2 b_2\r\n\\vdots\r\na_M b_M\n\nOutput\n\nIf there exists a cycle that contains vertex 1, print the minimum number of edges among such cycles. Otherwise, print -1.\n\nConstraints\n\n\n- 2 \\leq N \\leq 2 \\times 10^5\n- 1 \\leq M \\leq \\min \\left( \\frac{N(N-1)}{2},\\ 2 \\times 10^5 \\right)\n- 1 \\leq a_i \\leq N\n- 1 \\leq b_i \\leq N\n- a_i \\neq b_i\n- (a_i, b_i) \\neq (a_j, b_j) and (a_i, b_i) \\neq (b_j, a_j), if i \\neq j.\n- All input values are integers.\n\nSample Input 1\n\n3 3\r\n1 2\r\n2 3\r\n3 1\n\nSample Output 1\n\n3\r\n\nVertex 1 \\to vertex 2 \\to vertex 3 \\to vertex 1 is a cycle with three edges, and this is the only cycle that contains vertex 1.\n\nSample Input 2\n\n3 2\r\n1 2\r\n2 3\n\nSample Output 2\n\n-1\n\nSample Input 3\n\n6 9\r\n6 1\r\n1 5\r\n2 6\r\n2 1\r\n3 6\r\n4 2\r\n6 4\r\n3 5\r\n5 4\n\nSample Output 3\n\n4", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"3 3\\n1 2\\n2 3\\n3 1\\n\", \"output\": \"3\\n\", \"testtype\": \"stdin\"}, {\"input\": \"3 2\\n1 2\\n2 3\\n\", \"output\": \"-1\\n\", \"testtype\": \"stdin\"}, {\"input\": \"6 9\\n6 1\\n1 5\\n2 6\\n2 1\\n3 6\\n4 2\\n6 4\\n3 5\\n5 4\\n\", \"output\": \"4\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc378_f", "question_title": "Add One Edge 2", "question_content": "You are given a tree with N vertices. The i-th edge (1 \\leq i \\leq N-1) connects vertices u_i and v_i bidirectionally.\nAdding one undirected edge to the given tree always yields a graph with exactly one cycle.\nAmong such graphs, how many satisfy all of the following conditions?\n\n- The graph is simple.\n- All vertices in the cycle have degree 3.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN\r\nu_1 v_1\r\nu_2 v_2\r\n\\vdots\r\nu_{N-1} v_{N-1}\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- 3 \\leq N \\leq 2 \\times 10^5\n- 1 \\leq u_i, v_i \\leq N\n- The given graph is a tree.\n- All input values are integers.\n\nSample Input 1\n\n6\r\n1 2\r\n2 3\r\n3 4\r\n4 5\r\n3 6\n\nSample Output 1\n\n1\r\n\nAdding an edge connecting vertices 2 and 4 yields a simple graph where all vertices in the cycle have degree 3, so it satisfies the conditions.\n\nSample Input 2\n\n7\r\n1 2\r\n2 7\r\n3 5\r\n7 3\r\n6 2\r\n4 7\n\nSample Output 2\n\n0\r\n\nThere are cases where no graphs satisfy the conditions.\n\nSample Input 3\n\n15\r\n1 15\r\n11 14\r\n2 10\r\n1 7\r\n9 8\r\n6 9\r\n4 12\r\n14 5\r\n4 9\r\n8 11\r\n7 4\r\n1 13\r\n3 6\r\n11 10\n\nSample Output 3\n\n6", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"6\\n1 2\\n2 3\\n3 4\\n4 5\\n3 6\", \"output\": \"1\", \"testtype\": \"stdin\"}, {\"input\": \"7\\n1 2\\n2 7\\n3 5\\n7 3\\n6 2\\n4 7\", \"output\": \"0\", \"testtype\": \"stdin\"}, {\"input\": \"15\\n1 15\\n11 14\\n2 10\\n1 7\\n9 8\\n6 9\\n4 12\\n14 5\\n4 9\\n8 11\\n7 4\\n1 13\\n3 6\\n11 10\", \"output\": \"6\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc382_g", "question_title": "Tile Distance 3", "question_content": "Tiles are laid out covering the two-dimensional coordinate plane.\nEach tile is a rectangle, and for each integer triple (i, j, k) satisfying 0 \\leq k < K, a corresponding tile is placed according to the following rules:\n\n- When i and j have the same parity (both even or both odd), the tile corresponding to (i, j, k) covers the area where iK \\leq x \\leq (i + 1)K and jK + k \\leq y \\leq jK + k + 1.\n- When i and j have different parity, the tile corresponding to (i, j, k) covers the area where iK + k \\leq x \\leq iK + k + 1 and jK \\leq y \\leq (j + 1)K.\n\nTwo tiles are adjacent when their edges have a common segment of positive length.\nStarting from the tile containing the point (S_x + 0.5, S_y + 0.5), find the minimum number of times you need to move to an adjacent tile to reach the tile containing the point (T_x + 0.5, T_y + 0.5).\nThere are T test cases; solve each of them.\n\nInput\n\nThe input is given from Standard Input in the following format:\nT\r\n\\text{case}_1\r\n\\vdots\r\n\\text{case}_T\r\n\nEach case is given in the following format:\nK S_x S_y T_x T_y\n\nOutput\n\nPrint T lines. The i-th line should contain the answer for the i-th test case.\n\nConstraints\n\n\n- 1 \\leq T \\leq 10^4\n- 2 \\leq K \\leq 10^{16}\n- -10^{16} \\leq S_x, S_y, T_x, T_y \\leq 10^{16}\n- All input values are integers.\n\nSample Input 1\n\n3\r\n3 -2 1 4 -1\r\n4 8 8 0 2\r\n5 -1000000000000 -1000000000000 1000000000000 1000000000000\n\nSample Output 1\n\n4\r\n4\r\n800000000000\r\n\nLet us explain the first test case.\nLet (i, j, k) denote the tile corresponding to integer triple (i, j, k).\n(-1.5, 1.5) is contained in tile (-1, 0, 1), and (4.5, -0.5) is contained in tile (1, -1, 2).\nFor example, by moving from tile (-1, 0, 1) to (-1, 0, 2) to (0, 0, 2) to (1, 0, 0) to (1, -1, 2), you can reach tile (1, -1, 2) in four moves to an adjacent tile.", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3\\n3 -2 1 4 -1\\n4 8 8 0 2\\n5 -1000000000000 -1000000000000 1000000000000 1000000000000\", \"output\": \"4\\n4\\n800000000000\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc383_c", "question_title": "Humidifier 3", "question_content": "The AtCoder company office is represented as a grid of H rows and W columns. Let (i, j) denote the cell at the i-th row from the top and j-th column from the left.\nThe state of each cell is represented by a character S_{i,j}. If S_{i,j} is #, that cell has a wall; if S_{i,j} is ., that cell is a floor; if S_{i,j} is H, that cell has a humidifier placed on a floor cell.\nA certain cell is considered humidified if it can be reached from at least one humidifier cell by at most D moves up, down, left, or right without passing through a wall. Note that any cell with a humidifier is always humidified.\nFind the number of humidified floor cells.\n\nInput\n\nThe input is given from Standard Input in the following format:\nH W D\r\nS_{1,1}S_{1,2}\\cdotsS_{1,W}\r\nS_{2,1}S_{2,2}\\cdotsS_{2,W}\r\n\\vdots\r\nS_{H,1}S_{H,2}\\cdotsS_{H,W}\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- 1 \\leq H \\leq 1000\n- 1 \\leq W \\leq 1000\n- 0 \\leq D \\leq H\\times W\n- S_{i,j} is #, ., or H. (1 \\leq i \\leq H, 1 \\leq j \\leq W)\n- All input numbers are integers.\n\nSample Input 1\n\n3 4 1\r\nH...\r\n#..H\r\n.#.#\n\nSample Output 1\n\n5\r\n\nFive cells (1,1), (1,2), (1,4), (2,3), (2,4) are humidified.\n\nSample Input 2\n\n5 6 2\r\n##...H\r\nH.....\r\n..H.#.\r\n.HH...\r\n.###..\n\nSample Output 2\n\n21\n\nSample Input 3\n\n1 6 3\r\n...#..\n\nSample Output 3\n\n0\r\n\nIt is possible that no cells are humidified.", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"3 4 1\\nH...\\n#..H\\n.#.#\", \"output\": \"5\", \"testtype\": \"stdin\"}, {\"input\": \"5 6 2\\n##...H\\nH.....\\n..H.#.\\n.HH...\\n.###..\", \"output\": \"21\", \"testtype\": \"stdin\"}, {\"input\": \"1 6 3\\n...#..\", \"output\": \"0\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc383_e", "question_title": "Sum of Max Matching", "question_content": "You are given a simple connected undirected graph with N vertices and M edges, where vertices are numbered 1 to N and edges are numbered 1 to M. Edge i (1 \\leq i \\leq M) connects vertices u_i and v_i bidirectionally and has weight w_i.\nFor a path, define its weight as the maximum weight of an edge in the path.\nDefine f(x, y) as the minimum possible path weight of a path from vertex x to vertex y.\nYou are given two sequences of length K: (A_1, A_2, \\ldots, A_K) and (B_1, B_2, \\ldots, B_K). It is guaranteed that A_i \\neq B_j (1 \\leq i,j \\leq K).\nPermute the sequence B freely so that \\displaystyle \\sum_{i=1}^{K} f(A_i, B_i) is minimized.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M K\nu_1 v_1 w_1\nu_2 v_2 w_2\n\\vdots\nu_M v_M w_M\nA_1 A_2 \\ldots A_K\nB_1 B_2 \\ldots B_K\n\nOutput\n\nPrint the minimum value of \\displaystyle \\sum_{i=1}^{K} f(A_i, B_i).\n\nConstraints\n\n\n- 2 \\leq N  \\leq 2 \\times 10^5\n- N-1 \\leq M  \\leq \\min(\\frac{N \\times (N-1)}{2},2 \\times 10^5)\n- 1 \\leq K \\leq N\n- 1 \\leq u_i<v_i \\leq N (1 \\leq i \\leq M) \n- 1 \\leq w_i \\leq 10^9\n- 1 \\leq A_i,B_i \\leq N (1 \\leq i \\leq K)\n- The given graph is simple and connected.\n- All input values are integers.\n\nSample Input 1\n\n4 4 3\n1 3 2\n3 4 1\n2 4 5\n1 4 4\n1 1 3\n4 4 2\n\nSample Output 1\n\n8\n\nIf we rearrange B as (2,4,4):\n\n- f(1,2) = 5: The path from vertex 1 to vertex 2 passing through vertex 4 contains edge 3 with a maximum edge weight of 5. There is no path with a maximum edge weight less than or equal to 4, so 5 is the minimum possible.\n- f(1,4) = 2: The path from vertex 1 to vertex 4 passing through vertex 3 contains edge 1 with a maximum edge weight of 2. There is no path with a maximum edge weight less than or equal to 1, so 2 is the minimum possible.\n- f(3,4) = 1: The path from vertex 3 to vertex 4 passing through the direct edge contains an edge with a maximum edge weight of 1. No path can have a maximum weight 0 or less, so 1 is the minimum possible.\n\nThus, \\displaystyle \\sum_{i=1}^{3} f(A_i, B_i) = 5+2+1=8. No permutation of B yields 7 or less, so the answer is 8.\n\nSample Input 2\n\n3 3 2\n1 2 5\n2 3 2\n1 3 1\n1 1\n2 3\n\nSample Output 2\n\n3", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"4 4 3\\n1 3 2\\n3 4 1\\n2 4 5\\n1 4 4\\n1 1 3\\n4 4 2\", \"output\": \"8\", \"testtype\": \"stdin\"}, {\"input\": \"3 3 2\\n1 2 5\\n2 3 2\\n1 3 1\\n1 1\\n2 3\", \"output\": \"3\", \"testtype\": \"stdin\"}]"}
{"question_id": "arc188_c", "question_title": "Honest or Liar or Confused", "question_content": "There is a village with N villagers numbered from 1 to N.\nEach villager is honest or a liar. Additionally, some villagers are confused.\nYou have obtained M testimonies from the villagers. Each testimony is given by A_i, B_i, C_i for i=1,2,\\ldots,M, representing:\n\n- If C_i=0, villager A_i testified that villager B_i is honest.\n- If C_i=1, villager A_i testified that villager B_i is a liar.\n\nAll villagers know whether every other villager is honest or a liar, and you know that they made their testimonies to you according to the following rules:\n\n- An honest villager who is not confused always tells the truth.\n- A liar who is not confused always tells lies.\n- A confused honest villager always tells lies.\n- A confused liar always tells the truth.\n\nIn other words, if they are not confused, honest villagers always tell the truth, and liars always tell lies, but if they are confused, it is reversed.\nYou have decided to guess the set of villagers who are confused.\nGiven a choice of villagers who are confused, whether the set of testimonies \"contradicts\" or not is determined.\nHere, a set of testimonies is said to contradict if, no matter how you assign honest or liar statuses to the villagers, there is at least one testimony that violates the villagers' testimony rules.\nFind a set of confused villagers such that the given set of testimonies does not contradict.\nIf no such set of confused villagers exists, indicate that fact.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\nA_1 B_1 C_1\nA_2 B_2 C_2\n\\vdots\nA_M B_M C_M\n\nOutput\n\nIf there exists a set of confused villagers such that the given set of testimonies does not contradict, print a string of length N representing the set of confused villagers. In this string, the i-th character should be 1 if villager i is confused, and 0 otherwise.\nIf no such set of confused villagers exists, print -1.\n\nConstraints\n\n\n- 2 \\leq N \\leq 2 \\times 10^5\n- 0 \\leq M \\leq \\mathrm{min} \\lbrace 2 \\times 10^5,N(N-1) \\rbrace \n- 1 \\leq A_i, B_i \\leq N, A_i \\neq B_i\n- A_i \\neq A_j or B_i \\neq B_j for i \\neq j.\n- C_i = 0 or 1.\n- All input values are integers.\n\nSample Input 1\n\n3 3\n1 2 1\n1 3 0\n2 3 0\n\nSample Output 1\n\n010\n\nSuppose villager 1 is an honest villager who is not confused, villager 2 is a confused liar, and villager 3 is an honest villager who is not confused.\nIn this case, villager 1 correctly testifies that villager 2 is a liar and villager 3 is honest.\nAlso, villager 2, who is a liar but confused, tells the truth and testifies that villager 3 is honest.\nTherefore, all given testimonies are consistent with the villagers' testimony rules, so 010, indicating that only villager 2 is confused, is one valid output.\n\nSample Input 2\n\n3 6\n1 2 1\n1 3 0\n2 1 1\n2 3 0\n3 1 1\n3 2 0\n\nSample Output 2\n\n-1\n\nSuppose villagers 2 and 3 are confused.\nIn this case, there are 2^3=8 possible combinations for whether each villager is honest or a liar.\nAmong them, for example, if villager 1 is an honest villager who is not confused, villager 2 is a confused liar, and villager 3 is a confused honest villager, then according to the rules, villager 2 should tell the truth, but they falsely testify that villager 1 is a liar.\nYou can confirm that also in other combinations, there will be some testimonies that violate the rules.\nTherefore, if villagers 2 and 3 are confused, the given set of testimonies contradicts.\nIn fact, in this test case, no matter which villagers are confused, the given set of testimonies contradicts.\n\nSample Input 3\n\n3 0\n\nSample Output 3\n\n000\n\nThere may be any number of confused villagers, possibly zero or all.", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 3\\n1 2 1\\n1 3 0\\n2 3 0\", \"output\": \"010\", \"testtype\": \"stdin\"}, {\"input\": \"3 6\\n1 2 1\\n1 3 0\\n2 1 1\\n2 3 0\\n3 1 1\\n3 2 0\", \"output\": \"-1\", \"testtype\": \"stdin\"}, {\"input\": \"3 0\", \"output\": \"000\", \"testtype\": \"stdin\"}]"}
{"question_id": "arc189_c", "question_title": "Balls and Boxes", "question_content": "There are N boxes.\r\nFor i = 1, 2, \\ldots, N, the i-th box contains A_i red balls and B_i blue balls.\nYou are also given two permutations P = (P_1, P_2, \\ldots, P_N) and Q = (Q_1, Q_2, \\ldots, Q_N) of (1, 2, \\ldots, N).\nTakahashi can repeat the following operation any number of times, possibly zero:\n\n- Choose an integer 1 \\leq i \\leq N, and take all the balls from the i-th box into his hand.\n- Put all the red balls in his hand into the P_i-th box.\n- Put all the blue balls in his hand into the Q_i-th box.\n\nHis goal is to make a state where all boxes other than the X-th box contain no balls by repeating the above operations.\r\nDetermine whether it is possible to achieve his goal, and if possible, print the minimum number of operations needed to achieve it.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN X\r\nA_1 A_2 \\ldots A_N\r\nB_1 B_2 \\ldots B_N\r\nP_1 P_2 \\ldots P_N\r\nQ_1 Q_2 \\ldots Q_N\n\nOutput\n\nIf it is impossible for Takahashi to achieve a state where all boxes other than the X-th box contain no balls, print -1. If it is possible, print the minimum number of operations needed to achieve it.\n\nConstraints\n\n\n- 2 \\leq N \\leq 2 \\times 10^5\n- 0 \\leq A_i, B_i \\leq 1\n- 1 \\leq P_i, Q_i \\leq N\n- P and Q are permutations of (1, 2, \\ldots, N).\n- 1 \\leq X \\leq N\n- All input values are integers.\n\nSample Input 1\n\n5 3\r\n0 1 0 1 0\r\n0 0 1 0 1\r\n4 1 2 3 5\r\n3 4 5 2 1\n\nSample Output 1\n\n4\r\n\nThe numbers of red and blue balls in each box are A = (0, 1, 0, 1, 0) and B = (0, 0, 1, 0, 1), respectively.\r\nConsider the following steps:\n\n- First, perform the operation on the 5th box. As a result, A = (0, 1, 0, 1, 0), B = (1, 0, 1, 0, 0).\n- Next, perform the operation on the 2nd box. As a result, A = (1, 0, 0, 1, 0), B = (1, 0, 1, 0, 0).\n- Then, perform the operation on the 1st box. As a result, A = (0, 0, 0, 2, 0), B = (0, 0, 2, 0, 0).\n- Finally, perform the operation on the 4th box. As a result, A = (0, 0, 2, 0, 0), B = (0, 0, 2, 0, 0).\n\nThese four operations achieve a state where all boxes other than the X-th (3rd) box contain no balls.\r\nThis is the minimum number of operations possible.\n\nSample Input 2\n\n5 3\r\n0 0 0 0 0\r\n0 0 0 0 0\r\n4 1 2 3 5\r\n3 4 5 2 1\n\nSample Output 2\n\n0\r\n\nThere are no balls in any boxes.\r\nThus, the state where all boxes other than the X-th (3rd) box contain no balls is already achieved, so the required number of operations is 0.\n\nSample Input 3\n\n2 2\r\n1 1\r\n1 1\r\n1 2\r\n1 2\n\nSample Output 3\n\n-1\r\n\nThere is no way to perform the operation to achieve a state where all boxes other than the X-th (2nd) box contain no balls.\n\nSample Input 4\n\n10 10\r\n0 0 0 0 0 0 1 0 1 0\r\n0 0 0 0 1 1 0 0 1 0\r\n1 4 9 5 8 2 3 6 10 7\r\n7 4 9 10 6 3 1 2 8 5\n\nSample Output 4\n\n8", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"5 3\\n0 1 0 1 0\\n0 0 1 0 1\\n4 1 2 3 5\\n3 4 5 2 1\", \"output\": \"4\", \"testtype\": \"stdin\"}, {\"input\": \"5 3\\n0 0 0 0 0\\n0 0 0 0 0\\n4 1 2 3 5\\n3 4 5 2 1\", \"output\": \"0\", \"testtype\": \"stdin\"}, {\"input\": \"2 2\\n1 1\\n1 1\\n1 2\\n1 2\", \"output\": \"-1\", \"testtype\": \"stdin\"}, {\"input\": \"10 10\\n0 0 0 0 0 0 1 0 1 0\\n0 0 0 0 1 1 0 0 1 0\\n1 4 9 5 8 2 3 6 10 7\\n7 4 9 10 6 3 1 2 8 5\", \"output\": \"8\", \"testtype\": \"stdin\"}]"}
{"question_id": "3655", "question_title": "digit-operations-to-make-two-integers-equal", "question_content": "You are given two integers n and m that consist of the same number of digits.\nYou can perform the following operations any number of times:\n\nChoose any digit from n that is not 9 and increase it by 1.\nChoose any digit from n that is not 0 and decrease it by 1.\n\nThe integer n must not be a prime number at any point, including its original value and after each operation.\nThe cost of a transformation is the sum of all values that n takes throughout the operations performed.\nReturn the minimum cost to transform n into m. If it is impossible, return -1.\n \nExample 1:\n\nInput: n = 10, m = 12\nOutput: 85\nExplanation:\nWe perform the following operations:\n\nIncrease the first digit, now n = 20.\nIncrease the second digit, now n = 21.\nIncrease the second digit, now n = 22.\nDecrease the first digit, now n = 12.\n\n\nExample 2:\n\nInput: n = 4, m = 8\nOutput: -1\nExplanation:\nIt is impossible to make n equal to m.\n\nExample 3:\n\nInput: n = 6, m = 2\nOutput: -1\nExplanation: \nSince 2 is already a prime, we can't make n equal to m.\n\n \nConstraints:\n\n1 <= n, m < 10^4\nn and m consist of the same number of digits.", "difficulty": "medium", "starter_code": "class Solution:\n    def minOperations(self, n: int, m: int) -> int:\n        ", "public_test_cases": "[{\"input\": \"10\\n12\", \"output\": \"85\", \"testtype\": \"functional\"}, {\"input\": \"4\\n8\", \"output\": \"-1\", \"testtype\": \"functional\"}, {\"input\": \"6\\n2\", \"output\": \"-1\", \"testtype\": \"functional\"}]"}
{"question_id": "3680", "question_title": "count-connected-components-in-lcm-graph", "question_content": "You are given an array of integers nums of size n and a positive integer threshold.\nThere is a graph consisting of n nodes with the i^th node having a value of nums[i]. Two nodes i and j in the graph are connected via an undirected edge if lcm(nums[i], nums[j]) <= threshold.\nReturn the number of connected components in this graph.\nA connected component is a subgraph of a graph in which there exists a path between any two vertices, and no vertex of the subgraph shares an edge with a vertex outside of the subgraph.\nThe term lcm(a, b) denotes the least common multiple of a and b.\n \nExample 1:\n\nInput: nums = [2,4,8,3,9], threshold = 5\nOutput: 4\nExplanation: \n\n \nThe four connected components are (2, 4), (3), (8), (9).\n\nExample 2:\n\nInput: nums = [2,4,8,3,9,12], threshold = 10\nOutput: 2\nExplanation: \n\nThe two connected components are (2, 3, 4, 8, 9), and (12).\n\n \nConstraints:\n\n1 <= nums.length <= 10^5\n1 <= nums[i] <= 10^9\nAll elements of nums are unique.\n1 <= threshold <= 2 * 10^5", "difficulty": "hard", "starter_code": "class Solution:\n    def countComponents(self, nums: List[int], threshold: int) -> int:\n        ", "public_test_cases": "[{\"input\": \"[2, 4, 8, 3, 9]\\n5\", \"output\": \"4\", \"testtype\": \"functional\"}, {\"input\": \"[2, 4, 8, 3, 9, 12]\\n10\", \"output\": \"2\", \"testtype\": \"functional\"}]"}
{"question_id": "abc348_d", "question_title": "Medicines on Grid", "question_content": "There is a grid with H rows and W columns. Let (i, j) denote the cell at the i-th row from the top and the j-th column from the left. The state of each cell is represented by the character A_{i,j}, which means the following:\n\n- .: An empty cell.\n- #: An obstacle.\n- S: An empty cell and the start point.\n- T: An empty cell and the goal point.\n\nTakahashi can move from his current cell to a vertically or horizontally adjacent empty cell by consuming 1 energy. He cannot move if his energy is 0, nor can he exit the grid.\nThere are N medicines in the grid. The i-th medicine is at the empty cell (R_i, C_i) and can be used to set the energy to E_i. Note that the energy does not necessarily increase. He can use the medicine in his current cell. The used medicine will disappear.\nTakahashi starts at the start point with 0 energy and wants to reach the goal point. Determine if this is possible.\n\nInput\n\nThe input is given from Standard Input in the following format:\nH W\r\nA_{1, 1}A_{1, 2}\\cdotsA_{1, W}\r\nA_{2, 1}A_{2, 2}\\cdotsA_{2, W}\r\n\\vdots\r\nA_{H, 1}A_{H, 2}\\cdotsA_{H, W}\r\nN\r\nR_1 C_1 E_1\r\nR_2 C_2 E_2\r\n\\vdots\r\nR_N C_N E_N\n\nOutput\n\nIf Takahashi can reach the goal point from the start point, print Yes; otherwise, print No.\n\nConstraints\n\n\n- 1 \\leq H, W \\leq 200\n- A_{i, j} is one of ., #, S, and T.\n- Each of S and T exists exactly once in A_{i, j}.\n- 1 \\leq N \\leq 300\n- 1 \\leq R_i \\leq H\n- 1 \\leq C_i \\leq W\n- (R_i, C_i) \\neq (R_j, C_j) if i \\neq j.\n- A_{R_i, C_i} is not #.\n- 1 \\leq E_i \\leq HW\n\nSample Input 1\n\n4 4\r\nS...\r\n#..#\r\n#...\r\n..#T\r\n4\r\n1 1 3\r\n1 3 5\r\n3 2 1\r\n2 3 1\n\nSample Output 1\n\nYes\r\n\nFor example, he can reach the goal point as follows:\n\n- Use medicine 1. Energy becomes 3.\n- Move to (1, 2). Energy becomes 2.\n- Move to (1, 3). Energy becomes 1.\n- Use medicine 2. Energy becomes 5.\n- Move to (2, 3). Energy becomes 4.\n- Move to (3, 3). Energy becomes 3.\n- Move to (3, 4). Energy becomes 2.\n- Move to (4, 4). Energy becomes 1.\n\nThere is also medicine at (2, 3) along the way, but using it will prevent him from reaching the goal.\n\nSample Input 2\n\n2 2\r\nS.\r\nT.\r\n1\r\n1 2 4\n\nSample Output 2\n\nNo\r\n\nTakahashi cannot move from the start point.\n\nSample Input 3\n\n4 5\r\n..#..\r\n.S##.\r\n.##T.\r\n.....\r\n3\r\n3 1 5\r\n1 2 3\r\n2 2 1\n\nSample Output 3\n\nYes", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"4 4\\nS...\\n#..#\\n#...\\n..#T\\n4\\n1 1 3\\n1 3 5\\n3 2 1\\n2 3 1\\n\", \"output\": \"Yes\\n\", \"testtype\": \"stdin\"}, {\"input\": \"2 2\\nS.\\nT.\\n1\\n1 2 4\\n\", \"output\": \"No\\n\", \"testtype\": \"stdin\"}, {\"input\": \"4 5\\n..#..\\n.S##.\\n.##T.\\n.....\\n3\\n3 1 5\\n1 2 3\\n2 2 1\\n\", \"output\": \"Yes\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc350_d", "question_title": "New Friends", "question_content": "There is an SNS used by N users, labeled with numbers from 1 to N.\nIn this SNS, two users can become friends with each other.\r\nFriendship is bidirectional; if user X is a friend of user Y, user Y is always a friend of user X.\nCurrently, there are M pairs of friendships on the SNS, with the i-th pair consisting of users A_i and B_i.\nDetermine the maximum number of times the following operation can be performed:\n\n- Operation: Choose three users X, Y, and Z such that X and Y are friends, Y and Z are friends, but X and Z are not. Make X and Z friends.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\nA_1 B_1\r\n\\vdots\r\nA_M B_M\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- 2 \\leq N \\leq 2 \\times 10^5\n- 0 \\leq M \\leq 2 \\times 10^5\n- 1 \\leq A_i < B_i \\leq N\n- The pairs (A_i, B_i) are distinct.\n- All input values are integers.\n\nSample Input 1\n\n4 3\r\n1 2\r\n2 3\r\n1 4\n\nSample Output 1\n\n3\r\n\nThree new friendships with a friend's friend can occur as follows:\n\n- User 1 becomes friends with user 3, who is a friend of their friend (user 2)\n- User 3 becomes friends with user 4, who is a friend of their friend (user 1)\n- User 2 becomes friends with user 4, who is a friend of their friend (user 1)\n\nThere will not be four or more new friendships.\n\nSample Input 2\n\n3 0\n\nSample Output 2\n\n0\r\n\nIf there are no initial friendships, no new friendships can occur.\n\nSample Input 3\n\n10 8\r\n1 2\r\n2 3\r\n3 4\r\n4 5\r\n6 7\r\n7 8\r\n8 9\r\n9 10\n\nSample Output 3\n\n12", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"4 3\\n1 2\\n2 3\\n1 4\\n\", \"output\": \"3\\n\", \"testtype\": \"stdin\"}, {\"input\": \"3 0\\n\", \"output\": \"0\\n\", \"testtype\": \"stdin\"}, {\"input\": \"10 8\\n1 2\\n2 3\\n3 4\\n4 5\\n6 7\\n7 8\\n8 9\\n9 10\\n\", \"output\": \"12\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc351_d", "question_title": "Grid and Magnet", "question_content": "There is a grid of H rows and W columns. Some cells (possibly zero) contain magnets.\nThe state of the grid is represented by H strings S_1, S_2, \\ldots, S_H of length W. If the j-th character of S_i is #, it indicates that there is a magnet in the cell at the i-th row from the top and j-th column from the left; if it is ., it indicates that the cell is empty.\nTakahashi, wearing an iron armor, can move in the grid as follows:\n\n- If any of the cells vertically or horizontally adjacent to the current cell contains a magnet, he cannot move at all.\n- Otherwise, he can move to any one of the vertically or horizontally adjacent cells.\nHowever, he cannot exit the grid.\n\nFor each cell without a magnet, define its degree of freedom as the number of cells he can reach by repeatedly moving from that cell. Find the maximum degree of freedom among all cells without magnets in the grid.\nHere, in the definition of degree of freedom, \"cells he can reach by repeatedly moving\" mean cells that can be reached from the initial cell by some sequence of moves (possibly zero moves). It is not necessary that there is a sequence of moves that visits all such reachable cells starting from the initial cell. Specifically, each cell itself (without a magnet) is always included in the cells reachable from that cell.\n\nInput\n\nThe input is given from Standard Input in the following format:\nH W\nS_1\nS_2\n\\vdots\nS_H\n\nOutput\n\nPrint the maximum degree of freedom among all cells without magnets.\n\nConstraints\n\n\n- 1 \\leq H, W \\leq 1000\n- H and W are integers.\n- S_i is a string of length W consisting of . and #.\n- There is at least one cell without a magnet.\n\nSample Input 1\n\n3 5\n.#...\n.....\n.#..#\n\nSample Output 1\n\n9\n\nLet (i,j) denote the cell at the i-th row from the top and j-th column from the left. If Takahashi starts at (2,3), possible movements include:\n\n- (2,3) \\to (2,4) \\to (1,4) \\to (1,5) \\to (2,5)\n- (2,3) \\to (2,4) \\to (3,4)\n- (2,3) \\to (2,2)\n- (2,3) \\to (1,3)\n- (2,3) \\to (3,3)\n\nThus, including the cells he passes through, he can reach at least nine cells from (2,3).\nActually, no other cells can be reached, so the degree of freedom for (2,3) is 9.\nThis is the maximum degree of freedom among all cells without magnets, so print 9.\n\nSample Input 2\n\n3 3\n..#\n#..\n..#\n\nSample Output 2\n\n1\n\nFor any cell without a magnet, there is a magnet in at least one of the adjacent cells.\nThus, he cannot move from any of these cells, so their degrees of freedom are 1.\nTherefore, print 1.", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 5\\n.#...\\n.....\\n.#..#\\n\", \"output\": \"9\\n\", \"testtype\": \"stdin\"}, {\"input\": \"3 3\\n..#\\n#..\\n..#\\n\", \"output\": \"1\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc366_g", "question_title": "XOR Neighbors", "question_content": "You are given a simple undirected graph with N vertices and M edges. The i-th edge connects vertices u_i and v_i bidirectionally.\nDetermine if there exists a way to write an integer between 1 and 2^{60} - 1, inclusive, on each vertex of this graph so that the following condition is satisfied:\n\n- For every vertex v with a degree of at least 1, the total XOR of the numbers written on its adjacent vertices (excluding v itself) is 0.\n\n\nWhat is XOR?\n\nThe XOR of two non-negative integers A and B, denoted as A \\oplus B, is defined as follows:\n\n\n- In the binary representation of A \\oplus B, the bit at position 2^k \\, (k \\geq 0) is 1 if and only if exactly one of the bits at position 2^k in the binary representations of A and B is 1. Otherwise, it is 0.\n\n\nFor example, 3 \\oplus 5 = 6 (in binary: 011 \\oplus 101 = 110).\n\nIn general, the bitwise XOR of k integers p_1, \\dots, p_k is defined as (\\cdots ((p_1 \\oplus p_2) \\oplus p_3) \\oplus \\cdots \\oplus p_k).  It can be proved that this is independent of the order of p_1, \\dots, p_k.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\nu_1 v_1\nu_2 v_2\n\\vdots\nu_M v_M\n\nOutput\n\nIf there is no way to write integers satisfying the condition, print No.\nOtherwise, let X_v be the integer written on vertex v, and print your solution in the following format. If multiple solutions exist, any of them will be accepted.\nYes\nX_1 X_2 \\dots X_N\n\nConstraints\n\n\n- 1 \\leq N \\leq 60\n- 0 \\leq M \\leq N(N-1)/2\n- 1 \\leq u_i < v_i \\leq N\n- (u_i, v_i) \\neq (u_j, v_j) for i \\neq j.\n- All input values are integers.\n\nSample Input 1\n\n3 3\n1 2\n1 3\n2 3\n\nSample Output 1\n\nYes\n4 4 4\n\nOther acceptable solutions include writing (2,2,2) or (3,3,3).\n\nSample Input 2\n\n2 1\n1 2\n\nSample Output 2\n\nNo\n\nSample Input 3\n\n1 0\n\nSample Output 3\n\nYes\n1\n\nAny integer between 1 and 2^{60} - 1 can be written.\n\nSample Input 4\n\n4 5\n1 2\n1 3\n2 3\n2 4\n3 4\n\nSample Output 4\n\nYes\n12 4 4 8", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 3\\n1 2\\n1 3\\n2 3\\n\", \"output\": \"Yes\\n4 4 4\\n\", \"testtype\": \"stdin\"}, {\"input\": \"2 1\\n1 2\\n\", \"output\": \"No\\n\", \"testtype\": \"stdin\"}, {\"input\": \"1 0\\n\", \"output\": \"Yes\\n1\\n\", \"testtype\": \"stdin\"}, {\"input\": \"4 5\\n1 2\\n1 3\\n2 3\\n2 4\\n3 4\\n\", \"output\": \"Yes\\n12 4 4 8\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc369_e", "question_title": "Sightseeing Tour", "question_content": "There are N islands and M bidirectional bridges connecting two islands. The islands and bridges are numbered 1, 2, \\ldots, N and 1, 2, \\ldots, M, respectively.\r\nBridge i connects islands U_i and V_i, and the time it takes to cross it in either direction is T_i.\r\nNo bridge connects an island to itself, but it is possible for two islands to be directly connected by more than one bridge.\r\nOne can travel between any two islands using some bridges.\nYou are given Q queries, so answer each of them. The i-th query is as follows:\n\nYou are given K_i distinct bridges: bridges B_{i,1}, B_{i,2}, \\ldots, B_{i,K_i}.\r\nFind the minimum time required to travel from island 1 to island N using each of these bridges at least once.\r\nOnly consider the time spent crossing bridges.\r\nYou can cross the given bridges in any order and in any direction.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\nU_1 V_1 T_1\r\nU_2 V_2 T_2\r\n\\vdots\r\nU_M V_M T_M\r\nQ\r\nK_1\r\nB_{1,1} B_{1,2} \\cdots B_{1,{K_1}}\r\nK_2\r\nB_{2,1} B_{2,2} \\cdots B_{2,{K_2}}\r\n\\vdots\r\nK_Q\r\nB_{Q,1} B_{Q,2} \\cdots B_{Q,{K_Q}}\n\nOutput\n\nPrint Q lines. The i-th line (1 \\leq i \\leq Q) should contain the answer to the i-th query as an integer.\n\nConstraints\n\n\n- 2 \\leq N \\leq 400\n- N-1 \\leq M \\leq 2 \\times 10^5\n- 1 \\leq U_i < V_i \\leq N\n- 1 \\leq T_i \\leq 10^9\n- 1 \\leq Q \\leq 3000\n- 1 \\leq K_i \\leq 5\n- 1 \\leq B_{i,1} < B_{i,2} < \\cdots < B_{i,K_i} \\leq M\n- All input values are integers.\n- It is possible to travel between any two islands using some bridges.\n\nSample Input 1\n\n3 5\r\n1 2 10\r\n1 3 20\r\n1 3 30\r\n2 3 15\r\n2 3 25\r\n2\r\n1\r\n1\r\n2\r\n3 5\n\nSample Output 1\n\n25\r\n70\r\n\nFor the first query, we need to find the minimum time to travel from island 1 to island 3 while using bridge 1.\r\nThe minimum time is achieved by using bridge 1 to move from island 1 to island 2, then using bridge 4 to move from island 2 to island 3. The time taken is 10 + 15 = 25.\r\nHence, print 25 on the first line.\nFor the second query, we need to find the minimum time to travel from island 1 to island 3 while using both bridges 3 and 5.\r\nThe minimum time is achieved by using bridge 3 to move from island 1 to island 3, then using bridge 5 to move to island 2, and finally using bridge 4 to return to island 3. The time taken is 30 + 25 + 15 = 70.\r\nHence, print 70 on the second line.\n\nSample Input 2\n\n6 6\r\n1 5 1\r\n2 5 1\r\n2 4 1\r\n3 4 1\r\n3 6 1\r\n1 6 1\r\n2\r\n5\r\n1 2 3 4 5\r\n1\r\n5\n\nSample Output 2\n\n5\r\n3\r\n\nFor each query, you can cross the specified bridges in either direction.\n\nSample Input 3\n\n5 5\r\n1 2 1000000000\r\n2 3 1000000000\r\n3 4 1000000000\r\n4 5 1000000000\r\n1 5 1000000000\r\n1\r\n1\r\n3\n\nSample Output 3\n\n4000000000\r\n\nBeware that the answer may not fit in a 32-bit integer.", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 5\\n1 2 10\\n1 3 20\\n1 3 30\\n2 3 15\\n2 3 25\\n2\\n1\\n1\\n2\\n3 5\\n\", \"output\": \"25\\n70\\n\", \"testtype\": \"stdin\"}, {\"input\": \"6 6\\n1 5 1\\n2 5 1\\n2 4 1\\n3 4 1\\n3 6 1\\n1 6 1\\n2\\n5\\n1 2 3 4 5\\n1\\n5\\n\", \"output\": \"5\\n3\\n\", \"testtype\": \"stdin\"}, {\"input\": \"5 5\\n1 2 1000000000\\n2 3 1000000000\\n3 4 1000000000\\n4 5 1000000000\\n1 5 1000000000\\n1\\n1\\n3\\n\", \"output\": \"4000000000\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc371_g", "question_title": "Lexicographically Smallest Permutation", "question_content": "You are given permutations P = (P_1, P_2, \\ldots, P_N) and A = (A_1, A_2, \\ldots, A_N) of (1,2,\\ldots,N).\nYou can perform the following operation any number of times, possibly zero:\n\n- replace A_i with A_{P_i} simultaneously for all i=1,2,\\ldots,N.\n\nPrint the lexicographically smallest A that can be obtained.\nWhat is lexicographical order?\n For sequences of length N, A = (A_1, A_2, \\ldots, A_N) and B = (B_1, B_2, \\ldots, B_N), A is lexicographically smaller than B if and only if:\n\n- there exists an integer i\\ (1\\leq i\\leq N) such that A_i < B_i, and A_j = B_j for all 1\\leq j < i.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN\r\nP_1 P_2 \\ldots P_N\r\nA_1 A_2 \\ldots A_N\n\nOutput\n\nLet (A_1, A_2, \\ldots, A_N) be the lexicographically smallest A that can be obtained. Print A_1, A_2, \\ldots, A_N in this order, separated by spaces, in one line.\n\nConstraints\n\n\n- 1\\leq N\\leq2\\times10^5\n- 1\\leq P_i\\leq N\\ (1\\leq i\\leq N)\n- P_i\\neq P_j\\ (1\\leq i<j\\leq N)\n- 1\\leq A_i\\leq N\\ (1\\leq i\\leq N)\n- A_i\\neq A_j\\ (1\\leq i<j\\leq N)\n- All input values are integers.\n\nSample Input 1\n\n6\r\n3 1 5 6 2 4\r\n4 3 1 6 2 5\n\nSample Output 1\n\n1 4 2 5 3 6\r\n\nInitially, A = (4, 3, 1, 6, 2, 5).\nRepeating the operation yields the following.\n\n- A = (1, 4, 2, 5, 3, 6)\n- A = (2, 1, 3, 6, 4, 5)\n- A = (3, 2, 4, 5, 1, 6)\n- A = (4, 3, 1, 6, 2, 5)\n\nAfter this, A will revert to the original state every four operations.\nTherefore, print the lexicographically smallest among these, which is 1 4 2 5 3 6.\n\nSample Input 2\n\n8\r\n3 5 8 7 2 6 1 4\r\n1 2 3 4 5 6 7 8\n\nSample Output 2\n\n1 2 3 4 5 6 7 8\r\n\nYou may choose to perform no operations.\n\nSample Input 3\n\n26\r\n24 14 4 20 15 19 16 11 23 22 12 18 21 3 6 8 26 2 25 7 13 1 5 9 17 10\r\n15 3 10 1 13 19 22 24 20 4 14 23 7 26 25 18 11 6 9 12 2 21 5 16 8 17\n\nSample Output 3\n\n4 1 22 18 20 13 14 6 15 11 3 26 2 12 5 23 9 10 25 24 7 17 16 21 19 8", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"6\\n3 1 5 6 2 4\\n4 3 1 6 2 5\\n\", \"output\": \"1 4 2 5 3 6\\n\", \"testtype\": \"stdin\"}, {\"input\": \"8\\n3 5 8 7 2 6 1 4\\n1 2 3 4 5 6 7 8\\n\", \"output\": \"1 2 3 4 5 6 7 8\\n\", \"testtype\": \"stdin\"}, {\"input\": \"26\\n24 14 4 20 15 19 16 11 23 22 12 18 21 3 6 8 26 2 25 7 13 1 5 9 17 10\\n15 3 10 1 13 19 22 24 20 4 14 23 7 26 25 18 11 6 9 12 2 21 5 16 8 17\\n\", \"output\": \"4 1 22 18 20 13 14 6 15 11 3 26 2 12 5 23 9 10 25 24 7 17 16 21 19 8\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "arc183_b", "question_title": "Near Assignment", "question_content": "You are given integer sequences of length N: A=(A_1,A_2,\\cdots,A_N) and B=(B_1,B_2,\\cdots,B_N), and an integer K.\nYou can perform the following operation zero or more times.\n\n- Choose integers i and j (1 \\leq i,j \\leq N).\r\nHere, |i-j| \\leq K must hold.\r\nThen, change the value of A_i to A_j.\n\nDetermine whether it is possible to make A identical to B.\nThere are T test cases for each input.\n\nInput\n\nThe input is given from Standard Input in the following format:\nT\r\ncase_1\r\ncase_2\r\n\\vdots\r\ncase_T\r\n\nEach test case is given in the following format:\nN K\r\nA_1 A_2 \\cdots A_N\r\nB_1 B_2 \\cdots B_N\n\nOutput\n\nFor each test case, print Yes if it is possible to make A identical to B, and No otherwise.\n\nConstraints\n\n\n- 1 \\leq T \\leq 125000\n- 1 \\leq K < N \\leq 250000\n- 1 \\leq A_i,B_i \\leq N\n- The sum of N across all test cases in each input is at most 250000.\n- All input values are integers.\n\nSample Input 1\n\n4\r\n3 1\r\n1 1 2\r\n1 2 2\r\n5 4\r\n2 4 5 1 3\r\n2 1 3 2 2\r\n13 1\r\n3 1 3 3 5 3 3 4 2 2 2 5 1\r\n5 3 3 3 4 2 2 2 2 5 5 1 3\r\n20 14\r\n10 6 6 19 13 16 15 15 2 10 2 16 9 12 2 6 13 5 5 9\r\n5 9 6 2 10 19 16 15 13 12 10 2 9 6 5 16 19 12 15 13\n\nSample Output 1\n\nYes\r\nYes\r\nNo\r\nYes\r\n\nConsider the first test case.\r\nIf we operate with i=2 and j=3, the value of A_2 will be changed to A_3=2, resulting in A=(1,2,2).", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"4\\n3 1\\n1 1 2\\n1 2 2\\n5 4\\n2 4 5 1 3\\n2 1 3 2 2\\n13 1\\n3 1 3 3 5 3 3 4 2 2 2 5 1\\n5 3 3 3 4 2 2 2 2 5 5 1 3\\n20 14\\n10 6 6 19 13 16 15 15 2 10 2 16 9 12 2 6 13 5 5 9\\n5 9 6 2 10 19 16 15 13 12 10 2 9 6 5 16 19 12 15 13\\n\", \"output\": \"Yes\\nYes\\nNo\\nYes\\n\", \"testtype\": \"stdin\"}]"}
{"question_id": "3558", "question_title": "find-a-safe-walk-through-a-grid", "question_content": "You are given an m x n binary matrix grid and an integer health.\nYou start on the upper-left corner (0, 0) and would like to get to the lower-right corner (m - 1, n - 1).\nYou can move up, down, left, or right from one cell to another adjacent cell as long as your health remains positive.\nCells (i, j) with grid[i][j] = 1 are considered unsafe and reduce your health by 1.\nReturn true if you can reach the final cell with a health value of 1 or more, and false otherwise.\n \nExample 1:\n\nInput: grid = [[0,1,0,0,0],[0,1,0,1,0],[0,0,0,1,0]], health = 1\nOutput: true\nExplanation:\nThe final cell can be reached safely by walking along the gray cells below.\n\nExample 2:\n\nInput: grid = [[0,1,1,0,0,0],[1,0,1,0,0,0],[0,1,1,1,0,1],[0,0,1,0,1,0]], health = 3\nOutput: false\nExplanation:\nA minimum of 4 health points is needed to reach the final cell safely.\n\nExample 3:\n\nInput: grid = [[1,1,1],[1,0,1],[1,1,1]], health = 5\nOutput: true\nExplanation:\nThe final cell can be reached safely by walking along the gray cells below.\n\nAny path that does not go through the cell (1, 1) is unsafe since your health will drop to 0 when reaching the final cell.\n\n \nConstraints:\n\nm == grid.length\nn == grid[i].length\n1 <= m, n <= 50\n2 <= m * n\n1 <= health <= m + n\ngrid[i][j] is either 0 or 1.", "difficulty": "medium", "starter_code": "class Solution:\n    def findSafeWalk(self, grid: List[List[int]], health: int) -> bool:\n        ", "public_test_cases": "[{\"input\": \"[[0, 1, 0, 0, 0], [0, 1, 0, 1, 0], [0, 0, 0, 1, 0]]\\n1\", \"output\": \"true\", \"testtype\": \"functional\"}, {\"input\": \"[[0, 1, 1, 0, 0, 0], [1, 0, 1, 0, 0, 0], [0, 1, 1, 1, 0, 1], [0, 0, 1, 0, 1, 0]]\\n3\", \"output\": \"false\", \"testtype\": \"functional\"}, {\"input\": \"[[1, 1, 1], [1, 0, 1], [1, 1, 1]]\\n5\", \"output\": \"true\", \"testtype\": \"functional\"}]"}
{"question_id": "abc394_g", "question_title": "Dense Buildings", "question_content": "There is a city divided into H \\times W blocks in the north-south-east-west directions, and there is exactly one building in each block.\nSpecifically, in the block at the i-th row from the north (1\\leq i\\leq H) and the j-th column from the west (1\\leq j\\leq W) (hereafter referred to as block (i,j)), there is a building of F_{i,j} floors.\nTakahashi has two ways of moving. If he is on the X-th floor (1\\leq X\\leq F_{i,j}) of the building in block (i,j), he can:\n\n- Move up or down one floor within the same building using stairs. If X=1, he cannot move down; if X=F_{i,j}, he cannot move up.\n- Choose a building with at least X floors in a cardinally adjacent block, and move to the X-th floor of that building using a (sky) walkway.\n\nHere, two blocks (i,j) and (i',j') are cardinally adjacent if and only if \\lvert i - i'\\rvert + \\lvert j - j'\\rvert = 1.\nYou are given Q queries to be answered. The i-th query (1\\leq i\\leq Q) is the following.\n\nFind the minimum possible number of times that Takahashi uses stairs to move from the Y_i-th floor of the building in block (A_i,B_i) to the Z_i-th floor of the building in block (C_i,D_i).\nThe count of times using stairs is incremented each time he moves up or down one floor, possibly multiple times within the same building. (For example, moving from the 1st floor to the 6th floor of a building counts as 5 uses of stairs.)\nNote that he does not have to minimize the number of times he uses walkways.\n\nInput\n\nThe input is given from Standard Input in the following format:\nH W\nF_{1,1} F_{1,2} \\ldots F_{1,W}\nF_{2,1} F_{2,2} \\ldots F_{2,W}\n\\vdots\nF_{H,1} F_{H,2} \\ldots F_{H,W}\nQ\nA_1 B_1 Y_1 C_1 D_1 Z_1\nA_2 B_2 Y_2 C_2 D_2 Z_2\n\\vdots\nA_Q B_Q Y_Q C_Q D_Q Z_Q\n\nOutput\n\nPrint Q lines. The i-th line should contain the answer to the i-th query as an integer.\n\nConstraints\n\n\n- 1\\leq H \\leq 500\n- 1\\leq W \\leq 500\n- 1\\leq F_{i,j} \\leq 10^6\n- 1\\leq Q\\leq 2\\times 10^5\n- 1\\leq A_i,C_i\\leq H\n- 1\\leq B_i,D_i\\leq W\n- 1\\leq Y_i\\leq F_{A_i,B_i}\n- 1\\leq Z_i\\leq F_{C_i,D_i}\n- (A_i,B_i,Y_i)\\neq (C_i,D_i,Z_i)\n- All input values are integers.\n\nSample Input 1\n\n3 3\n12 10 6\n1 1 3\n8 6 7\n2\n1 1 10 3 1 6\n1 1 6 1 2 4\n\nSample Output 1\n\n10\n2\n\nFor the first query, for example, it is possible to move from the 10th floor of the building in block (1,1) to the 6th floor of the building in block (3,1) by using stairs a total of 10 times, in the following manner:\n\n- Move from the 10th floor of the building in block (1,1) to the 10th floor of the building in block (1,2) via a walkway.\n- Use stairs 4 times to go from the 10th floor down to the 6th floor of the building in block (1,2).\n- Move from the 6th floor of the building in block (1,2) to the 6th floor of the building in block (1,3) via a walkway.\n- Use stairs 3 times to go from the 6th floor down to the 3rd floor of the building in block (1,3).\n- Move from the 3rd floor of the building in block (1,3) to the 3rd floor of the building in block (2,3) via a walkway.\n- Move from the 3rd floor of the building in block (2,3) to the 3rd floor of the building in block (3,3) via a walkway.\n- Use stairs 3 times to go from the 3rd floor up to the 6th floor of the building in block (3,3).\n- Move from the 6th floor of the building in block (3,3) to the 6th floor of the building in block (3,2) via a walkway.\n- Move from the 6th floor of the building in block (3,2) to the 6th floor of the building in block (3,1) via a walkway.\n\nIt is impossible to make this journey using at most 9 uses of stairs, so we output 10.\nFor the second query, if you first use a walkway to go to the building in block (1,2), and then use the stairs twice to go from the 6th floor down to the 4th floor, it is possible to move from the 6th floor of the building in block (1,1) to the 4th floor of the building in block (1,2) by using the stairs twice.", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 3\\n12 10 6\\n1 1 3\\n8 6 7\\n2\\n1 1 10 3 1 6\\n1 1 6 1 2 4\", \"output\": \"10\\n2\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc395_e", "question_title": "Flip Edge", "question_content": "You are given a directed graph with N vertices and M edges.\r\nThe i-th edge (1 \\leq i \\leq M) is a directed edge from vertex u _ i to vertex v _ i.\nInitially, you are at vertex 1. You want to repeat the following operations until you reach vertex N:\n\n- Perform one of the two operations below:\n- Move along a directed edge from your current vertex. This incurs a cost of 1. More precisely, if you are at vertex v, choose a vertex u such that there is a directed edge from v to u, and move to vertex u.\n- Reverse the direction of all edges. This incurs a cost of X. More precisely, if and only if there was a directed edge from v to u immediately before this operation, there is a directed edge from u to v immediately after this operation.\n\n\n\nIt is guaranteed that, for the given graph, you can reach vertex N from vertex 1 by repeating these operations.\nFind the minimum total cost required to reach vertex N.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M X\r\nu _ 1 v _ 1\r\nu _ 2 v _ 2\r\n\\vdots\r\nu _ M v _ M\n\nOutput\n\nPrint the minimum total cost required to reach vertex N.\n\nConstraints\n\n\n- 2 \\leq N \\leq 2 \\times 10^5\n- 1 \\leq M \\leq 2 \\times 10^5\n- 1 \\leq X \\leq 10^9\n- 1 \\leq u _ i \\leq N \\ (1 \\leq i \\leq M)\n- 1 \\leq v _ i \\leq N \\ (1 \\leq i \\leq M)\n- For the given graph, it is guaranteed that you can reach vertex N from vertex 1 by the operations described.\n- All input values are integers.\n\nSample Input 1\n\n5 6 5\r\n1 2\r\n2 4\r\n3 1\r\n3 5\r\n4 3\r\n5 2\n\nSample Output 1\n\n4\r\n\nThe given graph looks like this:\n\nYou can reach vertex 5 with a total cost of 4 by doing the following:\n\n- Move to vertex 2 at a cost of 1.\n- Move to vertex 4 at a cost of 1.\n- Move to vertex 3 at a cost of 1.\n- Move to vertex 5 at a cost of 1.\n\nIt is impossible to reach vertex 5 with a total cost of 3 or less, so print 4.\n\nSample Input 2\n\n5 6 1\r\n1 2\r\n2 4\r\n3 1\r\n3 5\r\n4 3\r\n5 2\n\nSample Output 2\n\n3\r\n\nThe graph is the same as in Sample 1, but the cost to reverse edges is different.\nYou can reach vertex 5 with a total cost of 3 as follows:\n\n- Move to vertex 2 at a cost of 1.\n- Reverse all edges at a cost of 1.\n- Move to vertex 5 at a cost of 1.\n\nIt is impossible to reach vertex 5 with a total cost of 2 or less, so print 3.\n\nSample Input 3\n\n8 7 613566756\r\n2 1\r\n2 3\r\n4 3\r\n4 5\r\n6 5\r\n6 7\r\n8 7\n\nSample Output 3\n\n4294967299\r\n\nNote that the answer may exceed the 32-bit integer range.\n\nSample Input 4\n\n20 13 5\r\n1 3\r\n14 18\r\n18 17\r\n12 19\r\n3 5\r\n4 6\r\n13 9\r\n8 5\r\n14 2\r\n20 18\r\n8 14\r\n4 9\r\n14 8\n\nSample Output 4\n\n21", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"5 6 5\\n1 2\\n2 4\\n3 1\\n3 5\\n4 3\\n5 2\", \"output\": \"4\", \"testtype\": \"stdin\"}, {\"input\": \"5 6 1\\n1 2\\n2 4\\n3 1\\n3 5\\n4 3\\n5 2\", \"output\": \"3\", \"testtype\": \"stdin\"}, {\"input\": \"8 7 613566756\\n2 1\\n2 3\\n4 3\\n4 5\\n6 5\\n6 7\\n8 7\", \"output\": \"4294967299\", \"testtype\": \"stdin\"}, {\"input\": \"20 13 5\\n1 3\\n14 18\\n18 17\\n12 19\\n3 5\\n4 6\\n13 9\\n8 5\\n14 2\\n20 18\\n8 14\\n4 9\\n14 8\", \"output\": \"21\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc396_e", "question_title": "Min of Restricted Sum", "question_content": "You are given integers N, M and three integer sequences of length M: X = (X_1, X_2, \\ldots, X_M), Y = (Y_1, Y_2, \\ldots, Y_M), and Z = (Z_1, Z_2, \\ldots, Z_M). It is guaranteed that all elements of X and Y are between 1 and N, inclusive.\nWe call a length-N sequence of non-negative integers A = (A_1, A_2, \\ldots, A_N) a good sequence if and only if it satisfies the following condition:\n\n- For every integer i with 1 \\le i \\le M, the XOR of A_{X_i} and A_{Y_i} is Z_i.\n\nDetermine whether a good sequence A=(A_1,A_2,\\ldots,A_N) exists, and if it exists, find one good sequence that minimizes the sum of its elements \\displaystyle \\sum_{i=1}^N A_i.\n\nNotes on XOR\n\nFor non-negative integers A and B, their XOR A \\oplus B is defined as follows:\n\n\n- In the binary representation of A \\oplus B, the digit in the place corresponding to 2^k \\,(k \\ge 0) is 1 if and only if exactly one of the digits in the same place of A and B is 1; otherwise, it is 0.\n\n\nFor example, 3 \\oplus 5 = 6 (in binary: 011 \\oplus 101 = 110).\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\nX_1 Y_1 Z_1\nX_2 Y_2 Z_2\n\\vdots\nX_M Y_M Z_M\n\nOutput\n\nIf no good sequence exists, print -1.\nIf a good sequence exists, print one good sequence that minimizes the sum of its elements, separated by spaces.\nIf there are multiple good sequences with the same minimum sum, printing any of them is accepted.\n\nConstraints\n\n\n- 1 \\le N \\le 2\\times 10^5\n- 0 \\le M \\le 10^5\n- 1 \\le X_i, Y_i \\le N\n- 0 \\le Z_i \\le 10^9\n- All input values are integers.\n\nSample Input 1\n\n3 2\n1 3 4\n1 2 3\n\nSample Output 1\n\n0 3 4\n\nA=(0,3,4) is a good sequence because A_1 \\oplus A_2 = 3 and A_1 \\oplus A_3 = 4.\nOther good sequences include A=(1,2,5) and A=(7,4,3), but A=(0,3,4) has the smallest sum among all good sequences.\n\nSample Input 2\n\n3 3\n1 3 4\n1 2 3\n2 3 5\n\nSample Output 2\n\n-1\n\nNo good sequence exists, so print -1.\n\nSample Input 3\n\n5 8\n4 2 4\n2 3 11\n3 4 15\n4 5 6\n3 2 11\n3 3 0\n3 1 9\n3 4 15\n\nSample Output 3\n\n0 2 9 6 0", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 2\\n1 3 4\\n1 2 3\", \"output\": \"0 3 4\", \"testtype\": \"stdin\"}, {\"input\": \"3 3\\n1 3 4\\n1 2 3\\n2 3 5\", \"output\": \"-1\", \"testtype\": \"stdin\"}, {\"input\": \"5 8\\n4 2 4\\n2 3 11\\n3 4 15\\n4 5 6\\n3 2 11\\n3 3 0\\n3 1 9\\n3 4 15\", \"output\": \"0 2 9 6 0\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc396_d", "question_title": "Minimum XOR Path", "question_content": "You are given a simple connected undirected graph with N vertices numbered 1 through N and M edges numbered 1 through M. Edge i connects vertices u_i and v_i, and has a label w_i.\nAmong all simple paths (paths that do not pass through the same vertex more than once) from vertex 1 to vertex N, find the minimum XOR of the labels of the edges on the path.\n\nNotes on XOR\r\n\r\nFor non-negative integers A and B, their XOR A \\oplus B is defined as follows:\r\n\r\n\n- In the binary representation of A \\oplus B, the digit in the place corresponding to 2^k \\,(k \\ge 0) is 1 if and only if exactly one of the digits in the same place of A and B is 1; otherwise, it is 0.\n\r\n\r\nFor example, 3 \\oplus 5 = 6 (in binary: 011 \\oplus 101 = 110).\r\n\r\nIn general, the XOR of k integers p_1, \\dots, p_k is defined as (\\cdots ((p_1 \\oplus p_2) \\oplus p_3) \\oplus \\cdots \\oplus p_k). It can be proved that it does not depend on the order of p_1, \\dots, p_k.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\nu_1 v_1 w_1\r\nu_2 v_2 w_2\r\n\\vdots\r\nu_M v_M w_M\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- 2 \\leq N \\leq 10\n- N-1 \\leq M \\leq \\frac{N(N-1)}{2}\n- 1 \\leq u_i < v_i \\leq N\n- 0 \\leq w_i < 2^{60}\n- The given graph is a simple connected undirected graph.\n- All input values are integers.\n\nSample Input 1\n\n4 4\r\n1 2 3\r\n2 4 5\r\n1 3 4\r\n3 4 7\n\nSample Output 1\n\n3\r\n\nThere are two simple paths from vertex 1 to vertex 4:\n\n- 1 \\to 2 \\to 4\n- 1 \\to 3 \\to 4\n\nThe XOR of the labels on the edges of the first path is 6, and that of the second path is 3. Therefore, the answer is 3.\n\nSample Input 2\n\n4 3\r\n1 2 1\r\n2 3 2\r\n3 4 4\n\nSample Output 2\n\n7\n\nSample Input 3\n\n7 10\r\n1 2 726259430069220777\r\n1 4 988687862609183408\r\n1 5 298079271598409137\r\n1 6 920499328385871537\r\n1 7 763940148194103497\r\n2 4 382710956291350101\r\n3 4 770341659133285654\r\n3 5 422036395078103425\r\n3 6 472678770470637382\r\n5 7 938201660808593198\n\nSample Output 3\n\n186751192333709144", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"4 4\\n1 2 3\\n2 4 5\\n1 3 4\\n3 4 7\", \"output\": \"3\", \"testtype\": \"stdin\"}, {\"input\": \"4 3\\n1 2 1\\n2 3 2\\n3 4 4\", \"output\": \"7\", \"testtype\": \"stdin\"}, {\"input\": \"7 10\\n1 2 726259430069220777\\n1 4 988687862609183408\\n1 5 298079271598409137\\n1 6 920499328385871537\\n1 7 763940148194103497\\n2 4 382710956291350101\\n3 4 770341659133285654\\n3 5 422036395078103425\\n3 6 472678770470637382\\n5 7 938201660808593198\", \"output\": \"186751192333709144\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc397_g", "question_title": "Maximize Distance", "question_content": "You are given a directed graph with N vertices and M edges. The vertices are numbered 1,2,\\dots,N. Edge j (j=1,2,\\dots,M) goes from vertex u_j to vertex v_j. It is guaranteed that vertex N is reachable from vertex 1.\nInitially, all edges have weight 0. We choose exactly K out of the M edges and change their weights to 1. Find the maximum possible value of the shortest distance from vertex 1 to vertex N in the resulting graph.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M K\r\nu_1 v_1\r\nu_2 v_2\r\n\\vdots\r\nu_M v_M\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- 2 \\leq N \\leq 30\n- 1 \\leq K \\leq M \\leq 100\n- 1 \\leq u_j, v_j \\leq N\n- u_j \\neq v_j\n- In the given graph, vertex N is reachable from vertex 1.\n- All input values are integers.\n\nSample Input 1\n\n3 3 2\r\n1 2\r\n2 3\r\n1 3\n\nSample Output 1\n\n1\r\n\nBy choosing edges 1,3, the shortest distance from vertex 1 to vertex 3 becomes 1. There is no way to make the shortest distance 2 or greater, so the answer is 1.\n\nSample Input 2\n\n4 4 3\r\n1 2\r\n1 3\r\n3 2\r\n2 4\n\nSample Output 2\n\n2\r\n\nBy choosing edges 1,2,4, the shortest distance from vertex 1 to vertex 4 becomes 2. There is no way to make the shortest distance 3 or greater, so the answer is 2.\n\nSample Input 3\n\n2 2 1\r\n1 2\r\n1 2\n\nSample Output 3\n\n0\r\n\nNote that there may be multi-edges.", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 3 2\\n1 2\\n2 3\\n1 3\", \"output\": \"1\", \"testtype\": \"stdin\"}, {\"input\": \"4 4 3\\n1 2\\n1 3\\n3 2\\n2 4\", \"output\": \"2\", \"testtype\": \"stdin\"}, {\"input\": \"2 2 1\\n1 2\\n1 2\", \"output\": \"0\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc397_e", "question_title": "Path Decomposition of a Tree", "question_content": "You are given a tree with NK vertices. The vertices are numbered 1,2,\\dots,NK, and the i-th edge (i=1,2,\\dots,NK-1) connects vertices u_i and v_i bidirectionally.\nDetermine whether this tree can be decomposed into N paths, each of length K. More precisely, determine whether there exists an N \\times K matrix P satisfying the following:\n\n- P_{1,1}, \\dots, P_{1,K}, P_{2,1}, \\dots, P_{N,K} is a permutation of 1,2,\\dots,NK.\n- For each i=1,2,\\dots,N and j=1,2,\\dots,K-1, there is an edge connecting vertices P_{i,j} and P_{i,j+1}.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN K\r\nu_1 v_1\r\nu_2 v_2\r\n\\vdots\r\nu_{NK-1} v_{NK-1}\n\nOutput\n\nIf it is possible to decompose the tree into N paths each of length K, print Yes. Otherwise, print No.\n\nConstraints\n\n\n- 1 \\leq N\n- 1 \\leq K\n- NK \\leq 2 \\times 10^5\n- 1 \\leq u_i < v_i \\leq NK\n- The given graph is a tree.\n- All input values are integers.\n\nSample Input 1\n\n3 2\r\n1 2\r\n2 3\r\n3 4\r\n2 5\r\n5 6\n\nSample Output 1\n\nYes\r\n\nIt can be decomposed into a path with vertices 1,2, a path with vertices 3,4, and a path with vertices 5,6.\n\nSample Input 2\n\n3 2\r\n1 2\r\n2 3\r\n3 4\r\n2 5\r\n3 6\n\nSample Output 2\n\nNo", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"3 2\\n1 2\\n2 3\\n3 4\\n2 5\\n5 6\", \"output\": \"Yes\", \"testtype\": \"stdin\"}, {\"input\": \"3 2\\n1 2\\n2 3\\n3 4\\n2 5\\n3 6\", \"output\": \"No\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc399_e", "question_title": "Replace", "question_content": "You are given a positive integer N and two strings S and T, each of length N and consisting of lowercase English letters.\nDetermine whether it is possible to make S identical to T by repeating the operation below any number of times (possibly zero). If it is possible, also find the minimum number of operations required.\n\n- Choose two lowercase English letters x, y and replace every occurrence of x in S with y.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN\r\nS\r\nT\n\nOutput\n\nIf it is possible to make S identical to T, print the minimum number of operations required. Otherwise, print -1.\n\nConstraints\n\n\n- 1\\leq N \\leq 2\\times 10^5\n- N is an integer.\n- Each of S and T is a string of length N, consisting of lowercase English letters.\n\nSample Input 1\n\n6\r\nafbfda\r\nbkckbb\n\nSample Output 1\n\n4\r\n\nBy performing the operation four times in the following way, you can make S identical to T:\n\n- Choose x= b and y= c. S becomes afcfda.\n- Choose x= a and y= b. S becomes bfcfdb.\n- Choose x= f and y= k. S becomes bkckdb.\n- Choose x= d and y= b. S becomes bkckbb, which is identical to T.\n\nIt cannot be done with fewer than four operations, so the minimum number of operations required is 4.\n\nSample Input 2\n\n4\r\nabac\r\nabac\n\nSample Output 2\n\n0\r\n\nS and T are already identical, so no operations are required.\n\nSample Input 3\n\n4\r\nabac\r\nabrc\n\nSample Output 3\n\n-1\r\n\nNo matter how you repeat the operation, it is impossible to make S identical to T.\n\nSample Input 4\n\n4\r\nabac\r\nbcba\n\nSample Output 4\n\n4", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"6\\nafbfda\\nbkckbb\", \"output\": \"4\", \"testtype\": \"stdin\"}, {\"input\": \"4\\nabac\\nabac\", \"output\": \"0\", \"testtype\": \"stdin\"}, {\"input\": \"4\\nabac\\nabrc\", \"output\": \"-1\", \"testtype\": \"stdin\"}, {\"input\": \"4\\nabac\\nbcba\", \"output\": \"4\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc399_c", "question_title": "Make it Forest", "question_content": "You are given a simple undirected graph with N vertices and M edges, where the vertices are labeled 1 to N. The i-th edge connects vertices u_i and v_i.\r\nWhat is the minimum number of edges that need to be deleted from this graph so that the graph becomes a forest?\n\nWhat is a forest?\r\n\r\nA simple undirected graph F is called a forest if and only if F does not contain any cycle.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M\r\nu_1 v_1\r\nu_2 v_2\r\n\\vdots\r\nu_M v_M\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- 1 \\leq N \\leq 2 \\times 10^5\n- 0 \\leq M \\leq \\min \\left( \\frac{N(N-1)}{2}, 2 \\times 10^5\\right)\n- 1 \\leq u_i < v_i \\leq N\n- The given graph is simple.\n- All input values are integers.\n\nSample Input 1\n\n4 4\r\n1 2\r\n1 3\r\n2 4\r\n3 4\n\nSample Output 1\n\n1\r\n\nFor example, if you delete the first edge, the graph becomes a forest.\n\nSample Input 2\n\n5 0\n\nSample Output 2\n\n0\n\nSample Input 3\n\n10 10\r\n7 9\r\n4 6\r\n6 10\r\n2 5\r\n5 6\r\n5 9\r\n6 8\r\n4 8\r\n1 5\r\n1 4\n\nSample Output 3\n\n2", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"4 4\\n1 2\\n1 3\\n2 4\\n3 4\", \"output\": \"1\", \"testtype\": \"stdin\"}, {\"input\": \"5 0\", \"output\": \"0\", \"testtype\": \"stdin\"}, {\"input\": \"10 10\\n7 9\\n4 6\\n6 10\\n2 5\\n5 6\\n5 9\\n6 8\\n4 8\\n1 5\\n1 4\", \"output\": \"2\", \"testtype\": \"stdin\"}]"}
{"question_id": "abc400_d", "question_title": "Takahashi the Wall Breaker", "question_content": "Takahashi is about to go buy eel at a fish shop.\nThe town where he lives is divided into a grid of H rows and W columns. Each cell is either a road or a wall.\r\nLet us denote the cell at the i-th row from the top (1\\leq i \\leq H) and the j-th column from the left (1\\leq j \\leq W) as cell (i,j).\r\nInformation about each cell is given by H strings S_1,S_2,\\ldots,S_H, each of length W. Specifically, if the j-th character of S_i (1\\leq i \\leq H,1\\leq j\\leq W) is ., cell (i,j) is a road; if it is #, cell (i,j) is a wall.\nHe can repeatedly perform the following two types of actions in any order:\n\n- Move to an adjacent cell (up, down, left, or right) that is within the town and is a road.\n- Choose one of the four directions (up, down, left, or right) and perform a front kick in that direction.\r\n  When he performs a front kick, for each of the cells at most 2 steps away in that direction from the cell he is currently in, if that cell is a wall, it becomes a road.\r\n  If some of the cells at most 2 steps away are outside the town, a front kick can still be performed, but anything outside the town does not change.\n\nHe starts in cell (A,B), and he wants to move to the fish shop in cell (C,D).\r\nIt is guaranteed that both the cell where he starts and the cell with the fish shop are roads.\r\nFind the minimum number of front kicks he needs in order to reach the fish shop.\n\nInput\n\nThe input is given from Standard Input in the following format:\nH W\r\nS_1\r\nS_2\r\n\\vdots\r\nS_H\r\nA B C D\n\nOutput\n\nPrint the minimum number of front kicks needed for Takahashi to reach the fish shop.\n\nConstraints\n\n\n- 1\\leq H\\leq 1000\n- 1\\leq W\\leq 1000\n- Each S_i is a string of length W consisting of . and #.\n- 1\\leq A,C\\leq H\n- 1\\leq B,D\\leq W\n- (A,B)\\neq (C,D)\n- H, W, A, B, C, and D are integers.\n- The cell where Takahashi starts and the cell with the fish shop are roads.\n\nSample Input 1\n\n10 10\r\n..........\r\n#########.\r\n#.......#.\r\n#..####.#.\r\n##....#.#.\r\n#####.#.#.\r\n.##.#.#.#.\r\n###.#.#.#.\r\n###.#.#.#.\r\n#.....#...\r\n1 1 7 1\n\nSample Output 1\n\n1\r\n\nTakahashi starts in cell (1,1).\r\nBy repeatedly moving to adjacent road cells, he can reach cell (7,4).\r\nIf he performs a front kick to the left from cell (7,4), cells (7,3) and (7,2) turn from walls to roads.\r\nThen, by continuing to move through road cells (including those that have become roads), he can reach the fish shop in cell (7,1).\nIn this case, the number of front kicks performed is 1, and it is impossible to reach the fish shop without performing any front kicks, so print 1.\n\nSample Input 2\n\n2 2\r\n.#\r\n#.\r\n1 1 2 2\n\nSample Output 2\n\n1\r\n\nTakahashi starts in cell (1,1).\r\nWhen he performs a front kick to the right, cell (1,2) turns from a wall to a road.\r\nThe cell two steps to the right of (1,1) is outside the town, so it does not change.\r\nThen, he can move to cell (1,2) and then to the fish shop in cell (2,2).\nIn this case, the number of front kicks performed is 1, and it is impossible to reach the fish shop without performing any front kicks, so print 1.\n\nSample Input 3\n\n1 3\r\n.#.\r\n1 1 1 3\n\nSample Output 3\n\n1\r\n\nWhen performing a front kick, it is fine if the fish shop’s cell is within the cells that could be turned into a road. Specifically, the fish shop’s cell is a road from the beginning, so it remains unchanged; particularly, the shop is not destroyed by the front kick.\n\nSample Input 4\n\n20 20\r\n####################\r\n##...##....###...###\r\n#.....#.....#.....##\r\n#..#..#..#..#..#..##\r\n#..#..#....##..#####\r\n#.....#.....#..#####\r\n#.....#..#..#..#..##\r\n#..#..#.....#.....##\r\n#..#..#....###...###\r\n####################\r\n####################\r\n##..#..##...###...##\r\n##..#..#.....#.....#\r\n##..#..#..#..#..#..#\r\n##..#..#..#..#..#..#\r\n##.....#..#..#..#..#\r\n###....#..#..#..#..#\r\n#####..#.....#.....#\r\n#####..##...###...##\r\n####################\r\n3 3 18 18\n\nSample Output 4\n\n3", "difficulty": "medium", "starter_code": "", "public_test_cases": "[{\"input\": \"10 10\\n..........\\n#########.\\n#.......#.\\n#..####.#.\\n##....#.#.\\n#####.#.#.\\n.##.#.#.#.\\n###.#.#.#.\\n###.#.#.#.\\n#.....#...\\n1 1 7 1\", \"output\": \"1\", \"testtype\": \"stdin\"}, {\"input\": \"2 2\\n.#\\n#.\\n1 1 2 2\", \"output\": \"1\", \"testtype\": \"stdin\"}, {\"input\": \"1 3\\n.#.\\n1 1 1 3\", \"output\": \"1\", \"testtype\": \"stdin\"}, {\"input\": \"20 20\\n####################\\n##...##....###...###\\n#.....#.....#.....##\\n#..#..#..#..#..#..##\\n#..#..#....##..#####\\n#.....#.....#..#####\\n#.....#..#..#..#..##\\n#..#..#.....#.....##\\n#..#..#....###...###\\n####################\\n####################\\n##..#..##...###...##\\n##..#..#.....#.....#\\n##..#..#..#..#..#..#\\n##..#..#..#..#..#..#\\n##.....#..#..#..#..#\\n###....#..#..#..#..#\\n#####..#.....#.....#\\n#####..##...###...##\\n####################\\n3 3 18 18\", \"output\": \"3\", \"testtype\": \"stdin\"}]"}
{"question_id": "arc191_d", "question_title": "Moving Pieces on Graph", "question_content": "You are given a simple connected undirected graph with N vertices and M edges, where the vertices are numbered 1 to N and the edges are numbered 1 to M. Edge i connects vertex u_i and vertex v_i in both directions.\nInitially, there is a piece A on vertex S and a piece B on vertex T. Here, S and T are given as input.\nYou may perform the following operation any number of times in any order:\n\n- Choose either piece A or piece B, and move it from its current vertex to an adjacent vertex via an edge. However, you cannot make a move that results in both pieces ending up on the same vertex.\n\nYour goal is to reach the state in which piece A is on vertex T and piece B is on vertex S.\nDetermine whether this is possible, and if it is, find the minimum number of operations required to achieve it.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M S T\nu_1 v_1\nu_2 v_2\n\\vdots\nu_M v_M\n\nOutput\n\nIf it is impossible to achieve the goal, print -1.\nIf it is possible, print the minimum number of operations required.\n\nConstraints\n\n\n- 2 \\le N \\le 2\\times 10^5\n- \\displaystyle N-1 \\le M \\le \\min\\left(\\frac{N(N-1)}{2},\\,2\\times 10^5\\right)\n- 1 \\le u_i < v_i \\le N\n- The given graph is simple and connected.\n- 1 \\le S, T \\le N\n- S \\neq T\n- All input values are integers.\n\nSample Input 1\n\n4 4 3 4\n2 4\n1 4\n3 4\n2 3\n\nSample Output 1\n\n3\n\nFor example, the following sequence of operations completes the goal in three moves:\n\n- Move piece A to vertex 2.\n- Piece A is on vertex 2, piece B is on vertex 4.\n\n\n- Move piece B to vertex 3.\n- Piece A is on vertex 2, piece B is on vertex 3.\n\n\n- Move piece A to vertex 4.\n- Piece A is on vertex 4, piece B is on vertex 3.\n\n\n\nIt is impossible to complete the goal in fewer than three moves, so print 3.\n\nSample Input 2\n\n2 1 1 2\n1 2\n\nSample Output 2\n\n-1\n\nNo matter how you move the pieces, you cannot achieve the goal.\n\nSample Input 3\n\n5 6 3 5\n1 2\n2 3\n1 5\n2 4\n1 3\n2 5\n\nSample Output 3\n\n4", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"4 4 3 4\\n2 4\\n1 4\\n3 4\\n2 3\", \"output\": \"3\", \"testtype\": \"stdin\"}, {\"input\": \"2 1 1 2\\n1 2\", \"output\": \"-1\", \"testtype\": \"stdin\"}, {\"input\": \"5 6 3 5\\n1 2\\n2 3\\n1 5\\n2 4\\n1 3\\n2 5\", \"output\": \"4\", \"testtype\": \"stdin\"}]"}
{"question_id": "arc193_a", "question_title": "Complement Interval Graph", "question_content": "For integers l, r, let [l, r] denote the set of all integers from l through r. That is, [l, r] = \\lbrace l, l+1, l+2, \\ldots, r-1, r\\rbrace.\nYou are given N pairs of integers (L_1, R_1), (L_2, R_2), \\ldots, (L_N, R_N).\nBased on these pairs, consider an undirected graph G defined as follows:\n\n- It has N vertices numbered 1, 2, \\ldots, N.\n- For all i, j \\in [1, N], there is an undirected edge between vertices i and j if and only if the intersection of [L_i, R_i] and [L_j, R_j] is empty.\n\nIn addition, for each i = 1, 2, \\ldots, N, define the weight of vertex i to be W_i.\nYou are given Q queries about G. Process these queries in the order they are given.\nFor each i = 1, 2, \\ldots, Q, the i-th query is the following:\n\nYou are given integers s_i and t_i (both between 1 and N, inclusive) such that s_i \\neq t_i. Determine whether there exists a path from vertex s_i to vertex t_i in G. If it exists, print the minimum possible weight of such a path.\n\nHere, the weight of a path from vertex s to vertex t is defined as the sum of the weights of the vertices on that path (including both endpoints s and t).\n\nInput\n\nThe input is given from Standard Input in the following format:\nN\nW_1 W_2 \\cdots W_N\nL_1 R_1\nL_2 R_2\n\\vdots\nL_N R_N\nQ\ns_1 t_1\ns_2 t_2\n\\vdots\ns_Q t_Q\n\nOutput\n\nPrint Q lines.\nFor each i = 1, 2, \\ldots, Q, on the i-th line, if there exists a path from vertex s_i to vertex t_i, print the minimum possible weight of such a path, and print -1 otherwise.\n\nConstraints\n\n\n- 2 \\leq N \\leq 2 \\times 10^5\n- 1 \\leq Q \\leq 2 \\times 10^5\n- 1 \\leq W_i \\leq 10^9\n- 1 \\leq L_i \\leq R_i \\leq 2N\n- 1 \\leq s_i, t_i \\leq N\n- s_i \\neq t_i\n- All input values are integers.\n\nSample Input 1\n\n5\n5 1 4 2 2\n2 4\n1 2\n7 8\n4 5\n2 7\n3\n1 4\n4 3\n5 2\n\nSample Output 1\n\n11\n6\n-1\n\nG is a graph with four undirected edges: \\lbrace 1, 3\\rbrace, \\lbrace 2, 3\\rbrace, \\lbrace 2, 4\\rbrace, \\lbrace 3, 4\\rbrace.\n\n- For the first query, there is a path from vertex 1 to vertex 4 given by 1 \\to 3 \\to 4. The weight of this path is W_1 + W_3 + W_4 = 5 + 4 + 2 = 11, and this is the minimum possible.\n- For the second query, there is a path from vertex 4 to vertex 3 given by 4 \\to 3. The weight of this path is W_4 + W_3 = 2 + 4 = 6, and this is the minimum possible.\n- For the third query, there is no path from vertex 5 to vertex 2. Hence, print -1.\n\nSample Input 2\n\n8\n44 75 49 4 78 79 12 32\n5 13\n10 16\n6 8\n6 15\n12 15\n5 7\n1 15\n1 2\n5\n5 6\n3 2\n7 5\n4 5\n5 4\n\nSample Output 2\n\n157\n124\n-1\n114\n114", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"5\\n5 1 4 2 2\\n2 4\\n1 2\\n7 8\\n4 5\\n2 7\\n3\\n1 4\\n4 3\\n5 2\", \"output\": \"11\\n6\\n-1\", \"testtype\": \"stdin\"}, {\"input\": \"8\\n44 75 49 4 78 79 12 32\\n5 13\\n10 16\\n6 8\\n6 15\\n12 15\\n5 7\\n1 15\\n1 2\\n5\\n5 6\\n3 2\\n7 5\\n4 5\\n5 4\", \"output\": \"157\\n124\\n-1\\n114\\n114\", \"testtype\": \"stdin\"}]"}
{"question_id": "arc196_c", "question_title": "Strongly Connected", "question_content": "There is a directed graph with 2N vertices and 2N-1 edges.\r\nThe vertices are numbered 1, 2, \\ldots, 2N, and the i-th edge is a directed edge from vertex i to vertex i+1.\nYou are given a length-2N string S = S_1 S_2 \\ldots S_{2N} consisting of N Ws and N Bs.\r\nVertex i is colored white if S_i is W, and black if S_i is B.\nYou will perform the following series of operations:\n\n- Partition the 2N vertices into N pairs, each consisting of one white vertex and one black vertex.\n- For each pair, add a directed edge from the white vertex to the black vertex.\n\nPrint the number, modulo 998244353, of ways to partition the vertices into N pairs such that the final graph is strongly connected.\n Notes on strongly connectedness\nA directed graph is strongly connected if and only if it is possible to travel from any vertex to any vertex by following edges.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN\r\nS\n\nOutput\n\nPrint the number, modulo 998244353, of ways to partition the vertices into N pairs so that the final graph is strongly connected.\n\nConstraints\n\n\n- 1 \\le N \\le 2\\times 10^5\n- S is a length 2N string consisting of N Ws and N Bs.\n- N is an integer.\n\nSample Input 1\n\n2\r\nBWBW\n\nSample Output 1\n\n1\r\n\nVertices 2,4 are white, and vertices 1,3 are black.\nLet (u,v) denote an edge from vertex u to vertex v.\nIf we pair up vertices as (2,1), (4,3), the final graph have the edges (1,2), (2,3), (3,4), (2,1), (4,3). In this case, for example, it is impossible to travel from vertex 3 to vertex 1 by following edges, so this graph is not strongly connected.\nIf we pair up vertices as (2,3), (4,1), the final graph have the edges (1,2), (2,3), (3,4), (2,3), (4,1). This graph is strongly connected.\nTherefore, there is exactly 1 way to pair up the vertices that satisfies the condition.\n\nSample Input 2\n\n4\r\nBWWBWBWB\n\nSample Output 2\n\n0\r\n\nNo matter how you pair up the vertices, you cannot satisfy the condition.\n\nSample Input 3\n\n9\r\nBWWBWBBBWWBWBBWWBW\n\nSample Output 3\n\n240792", "difficulty": "hard", "starter_code": "", "public_test_cases": "[{\"input\": \"2\\nBWBW\", \"output\": \"1\", \"testtype\": \"stdin\"}, {\"input\": \"4\\nBWWBWBWB\", \"output\": \"0\", \"testtype\": \"stdin\"}, {\"input\": \"9\\nBWWBWBBBWWBWBBWWBW\", \"output\": \"240792\", \"testtype\": \"stdin\"}]"}
{"question_id": "3720", "question_title": "minimize-the-maximum-edge-weight-of-graph", "question_content": "You are given two integers, n and threshold, as well as a directed weighted graph of n nodes numbered from 0 to n - 1. The graph is represented by a 2D integer array edges, where edges[i] = [A_i, B_i, W_i] indicates that there is an edge going from node A_i to node B_i with weight W_i.\nYou have to remove some edges from this graph (possibly none), so that it satisfies the following conditions:\n\nNode 0 must be reachable from all other nodes.\nThe maximum edge weight in the resulting graph is minimized.\nEach node has at most threshold outgoing edges.\n\nReturn the minimum possible value of the maximum edge weight after removing the necessary edges. If it is impossible for all conditions to be satisfied, return -1.\n \nExample 1:\n\nInput: n = 5, edges = [[1,0,1],[2,0,2],[3,0,1],[4,3,1],[2,1,1]], threshold = 2\nOutput: 1\nExplanation:\n\nRemove the edge 2 -> 0. The maximum weight among the remaining edges is 1.\n\nExample 2:\n\nInput: n = 5, edges = [[0,1,1],[0,2,2],[0,3,1],[0,4,1],[1,2,1],[1,4,1]], threshold = 1\nOutput: -1\nExplanation: \nIt is impossible to reach node 0 from node 2.\n\nExample 3:\n\nInput: n = 5, edges = [[1,2,1],[1,3,3],[1,4,5],[2,3,2],[3,4,2],[4,0,1]], threshold = 1\nOutput: 2\nExplanation: \n\nRemove the edges 1 -> 3 and 1 -> 4. The maximum weight among the remaining edges is 2.\n\nExample 4:\n\nInput: n = 5, edges = [[1,2,1],[1,3,3],[1,4,5],[2,3,2],[4,0,1]], threshold = 1\nOutput: -1\n\n \nConstraints:\n\n2 <= n <= 10^5\n1 <= threshold <= n - 1\n1 <= edges.length <= min(10^5, n * (n - 1) / 2).\nedges[i].length == 3\n0 <= A_i, B_i < n\nA_i != B_i\n1 <= W_i <= 10^6\nThere may be multiple edges between a pair of nodes, but they must have unique weights.", "difficulty": "medium", "starter_code": "class Solution:\n    def minMaxWeight(self, n: int, edges: List[List[int]], threshold: int) -> int:\n        ", "public_test_cases": "[{\"input\": \"5\\n[[1, 0, 1], [2, 0, 2], [3, 0, 1], [4, 3, 1], [2, 1, 1]]\\n2\", \"output\": \"1\", \"testtype\": \"functional\"}, {\"input\": \"5\\n[[0, 1, 1], [0, 2, 2], [0, 3, 1], [0, 4, 1], [1, 2, 1], [1, 4, 1]]\\n1\", \"output\": \"-1\", \"testtype\": \"functional\"}, {\"input\": \"5\\n[[1, 2, 1], [1, 3, 3], [1, 4, 5], [2, 3, 2], [3, 4, 2], [4, 0, 1]]\\n1\", \"output\": \"2\", \"testtype\": \"functional\"}, {\"input\": \"5\\n[[1, 2, 1], [1, 3, 3], [1, 4, 5], [2, 3, 2], [4, 0, 1]]\\n1\", \"output\": \"-1\", \"testtype\": \"functional\"}]"}
{"question_id": "3809", "question_title": "properties-graph", "question_content": "You are given a 2D integer array properties having dimensions n x m and an integer k.\nDefine a function intersect(a, b) that returns the number of distinct integers common to both arrays a and b.\nConstruct an undirected graph where each index i corresponds to properties[i]. There is an edge between node i and node j if and only if intersect(properties[i], properties[j]) >= k, where i and j are in the range [0, n - 1] and i != j.\nReturn the number of connected components in the resulting graph.\n \nExample 1:\n\nInput: properties = [[1,2],[1,1],[3,4],[4,5],[5,6],[7,7]], k = 1\nOutput: 3\nExplanation:\nThe graph formed has 3 connected components:\n\n\nExample 2:\n\nInput: properties = [[1,2,3],[2,3,4],[4,3,5]], k = 2\nOutput: 1\nExplanation:\nThe graph formed has 1 connected component:\n\n\nExample 3:\n\nInput: properties = [[1,1],[1,1]], k = 2\nOutput: 2\nExplanation:\nintersect(properties[0], properties[1]) = 1, which is less than k. This means there is no edge between properties[0] and properties[1] in the graph.\n\n \nConstraints:\n\n1 <= n == properties.length <= 100\n1 <= m == properties[i].length <= 100\n1 <= properties[i][j] <= 100\n1 <= k <= m", "difficulty": "medium", "starter_code": "class Solution:\n    def numberOfComponents(self, properties: List[List[int]], k: int) -> int:\n        ", "public_test_cases": "[{\"input\": \"[[1, 2], [1, 1], [3, 4], [4, 5], [5, 6], [7, 7]]\\n1\", \"output\": \"3\", \"testtype\": \"functional\"}, {\"input\": \"[[1, 2, 3], [2, 3, 4], [4, 3, 5]]\\n2\", \"output\": \"1\", \"testtype\": \"functional\"}, {\"input\": \"[[1, 1], [1, 1]]\\n2\", \"output\": \"2\", \"testtype\": \"functional\"}]"}
